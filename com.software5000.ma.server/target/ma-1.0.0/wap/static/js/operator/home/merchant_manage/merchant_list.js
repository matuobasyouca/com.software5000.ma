webpackJsonp([2],{190:function(e,s,t){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var a=t(6),i=t.n(a),n=t(28),o=t.n(n),l=t(2);s.default={components:{maHead:i.a,search:o.a},data:function(){return{isLoading:!0,startPage:1,pageSize:10,hasNextPage:!1,keyWord:"",merchantList:[],salesPopVisible:!1,businessId:"",busniessName:"",deptId:"",employeeId:"",setEmployeeId:"",deptOptions:[],employeeOptions:[]}},methods:{handleGoBack:function(){t.i(l.d)("/wap/operator/home/workbench.html")},handleSearch:function(){var e=this.$loading();this.getMerchantList(!1,function(){e.close()},e)},getMerchantList:function(e,s,t){var a=this;e?this.startPage++:this.startPage=1,this.$ajax(this.$joggle.business.selectBusinessListPage,{startPage:this.startPage,pageSize:this.pageSize,businessName:this.keyWord,orderBy:"businessLineState ASC ,createTime DESC "},t,function(t,i){i.close(),"ZS011000"===t.code?(a.hasNextPage=t.data.hasNextPage,a.merchantList=e?a.merchantList.concat(t.data.list):t.data.list,s&&s()):a.$message({type:"error",message:t.msg,duration:1200})})},setLabelClass:function(e){return 1==e?"label-green":2==e?"label-gray":void 0},handleSetAddress:function(e){var s="";return e.areaList.forEach(function(e){s+=e.areaName}),s+=e.businessAddress},handleShowMore:function(){if(this.hasNextPage){var e=this.$loading();this.getMerchantList(!0,function(){e.close()},e)}},handleToAccountManage:function(e,s){s?t.i(l.d)("/wap/operator/home/merchant_manage/account_insert.html",{businessId:e,id:s}):t.i(l.d)("/wap/operator/home/merchant_manage/account_insert.html",{businessId:e})},handleToEdit:function(e){t.i(l.d)("/wap/operator/home/merchant_manage/merchant_edit.html",{businessId:e})},handleToInsert:function(){t.i(l.d)("/wap/operator/home/merchant_manage/merchant_insert.html")},selectDepartment:function(e,s){var t=this;this.$ajax(this.$joggle.business.selectDepartment,{},s,function(s,a){"ZS021000"===s.code?(t.deptOptions=s.data,e&&e()):(a.close(),t.$message({type:"error",message:s.msg,duration:1200}))})},selectSalesByDeptId:function(e,s){var a=this;if(this.employeeId="",t.i(l.c)(this.deptId))return void(e&&e());this.$ajax(this.$joggle.business.selectSalesByDeptId,{departmentId:this.deptId,roleName:"SalesMan",state:1},s,function(s,t){t.close(),"ZS021000"===s.code?(a.employeeOptions=s.data,e&&e()):a.$message({type:"error",message:s.msg,duration:1200})})},selectSalesByMerchant:function(e,s){var t=this;this.$ajax(this.$joggle.business.selectSalesByMerchant,{businessId:e},!0,function(a,i){"ZS021000"===a.code?(t.businessId=e,t.businessName=s,a.data?(t.deptId=a.data.departmentId||"",t.setEmployeeId=a.data.id||"",t.selectSalesByDeptId(function(){t.employeeId=a.data.employeeId||"",i.close()},i)):i.close(),t.salesPopVisible=!0):(i.close(),t.$message({type:"error",message:a.msg,duration:1200}))})},handleConfirmSetSales:function(){var e=this;if(t.i(l.c)(this.employeeId))return void this.$message({type:"error",message:"请选择销售顾问",duration:1200});var s=t.i(l.c)(this.setEmployeeId)?"insertMerchantSales":"updateMerchantSales";this.$ajax(this.$joggle.business[""+s],{businessId:this.businessId,businessName:this.businessName,employeeId:this.employeeId,id:this.setEmployeeId},!0,function(s,t){"ZS021000"===s.code?(e.salesPopVisible=!1,e.$message({type:"success",message:s.msg,duration:1200}),setTimeout(function(){e.deptId=e.employeeId=e.setEmployeeId="",e.businessId=e.busniessName="",t.close()},1200)):(t.close(),e.$message({type:"error",message:s.msg,duration:1200}))})},handleCancelSetSales:function(){this.deptId=this.employeeId=this.setEmployeeId="",this.businessId=this.busniessName="",this.salesPopVisible=!1}},created:function(){var e=this,s=this.$loading(),t=new Promise(function(t){e.getMerchantList(!1,function(){t()},s)}),a=new Promise(function(t){e.selectDepartment(function(){t()},s)});Promise.all([t,a]).then(function(){s.close(),e.isLoading=!1})}}},24:function(e,s,t){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var a=t(19);s.default={name:"search",directives:{clickoutside:a.a},props:{title:String,placeholder:String},data:function(){return{keyWord:"",isFocus:!1}},watch:{keyWord:function(e){this.$emit("input",e)}},methods:{handleFocus:function(){this.isFocus=!0},handleBlur:function(){this.isFocus=!1},handleControl:function(){this.$emit("search",this.keyWord)}}}},265:function(e,s,t){t(358);var a=t(0)(t(190),t(282),null,null);e.exports=a.exports},28:function(e,s,t){t(35);var a=t(0)(t(24),t(32),null,null);e.exports=a.exports},282:function(e,s){e.exports={render:function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{directives:[{name:"show",rawName:"v-show",value:!e.isLoading,expression:"!isLoading"}],staticClass:"merchant-list-page"},[t("ma-head",{attrs:{home:!1,"go-back":!1,"right-icon-text":"添加商家"},on:{"left-icon-click":e.handleGoBack,"right-icon-click":e.handleToInsert}},[e._v("商家管理\n    ")]),e._v(" "),t("search",{attrs:{placeholder:"请输入商家名称关键字搜索"},on:{search:e.handleSearch},model:{value:e.keyWord,callback:function(s){e.keyWord=s},expression:"keyWord"}}),e._v(" "),t("ul",{staticClass:"merchant-list"},[e._l(e.merchantList,function(s){return t("li",{key:s.id},[t("div",{staticClass:"merchant-list-item"},[t("div",{staticClass:"merchant-pic",style:{backgroundImage:"url("+s.imageShowPath+")"}}),e._v(" "),t("span",{staticClass:"state-label",class:e.setLabelClass(s.businessLineState)},[e._v(e._s(s.businessLineStateDes))]),e._v(" "),t("p",{staticClass:"merchant-name"},[e._v(e._s(s.businessName))]),e._v(" "),t("zs-icon",{staticClass:"merchant-address",attrs:{icon:"address",size:"14",text:e.handleSetAddress(s)}}),e._v(" "),t("zs-icon",{staticClass:"merchant-tel",attrs:{icon:"tel-gray",size:"14",text:s.businessTel}})],1),e._v(" "),t("p",{staticClass:"merchant-list-control clr"},[t("zs-icon",{attrs:{icon:"shang",size:"14",text:"设置顾问"},on:{click:function(t){e.selectSalesByMerchant(s.id,s.businessName)}}}),e._v(" "),t("zs-icon",{attrs:{icon:"account",size:"14",text:"账号管理"},on:{click:function(t){e.handleToAccountManage(s.id,s.bossId)}}}),e._v(" "),t("zs-icon",{attrs:{icon:"edit",size:"14",text:"编辑"},on:{click:function(t){e.handleToEdit(s.id)}}})],1)])}),e._v(" "),0==e.merchantList.length?t("li",{staticClass:"list-empty"},[e._v("暂无记录")]):e._e()],2),e._v(" "),t("p",{directives:[{name:"show",rawName:"v-show",value:e.merchantList.length>0,expression:"merchantList.length>0"}],staticClass:"show-more",class:[{"no-more":!e.hasNextPage}],on:{click:e.handleShowMore}},[e._v("\n        "+e._s(e.hasNextPage?"查看更多":"已显示全部"))]),e._v(" "),t("zs-dialog",{staticClass:"sales-select-pop",attrs:{title:"设置门店顾问"},model:{value:e.salesPopVisible,callback:function(s){e.salesPopVisible=s},expression:"salesPopVisible"}},[t("div",{staticClass:"sales-select-item"},[t("span",[e._v("选择门店")]),e._v(" "),t("div",{staticClass:"sales-select-wrapper"},[t("select",{directives:[{name:"model",rawName:"v-model",value:e.deptId,expression:"deptId"}],staticClass:"sales-select",on:{change:[function(s){var t=Array.prototype.filter.call(s.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});e.deptId=s.target.multiple?t:t[0]},function(s){e.selectSalesByDeptId("",!0)}]}},[t("option",{attrs:{value:""}},[e._v("请选择门店")]),e._v(" "),e._l(e.deptOptions,function(s){return t("option",{domProps:{value:s.id}},[e._v(e._s(s.name))])})],2)])]),e._v(" "),t("div",{staticClass:"sales-select-item"},[t("span",[e._v("选择顾问")]),e._v(" "),t("div",{staticClass:"sales-select-wrapper"},[t("select",{directives:[{name:"model",rawName:"v-model",value:e.employeeId,expression:"employeeId"}],staticClass:"sales-select",on:{change:function(s){var t=Array.prototype.filter.call(s.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});e.employeeId=s.target.multiple?t:t[0]}}},[t("option",{attrs:{value:""}},[e._v("请选择销售顾问")]),e._v(" "),e._l(e.employeeOptions,function(s){return t("option",{domProps:{value:s.id}},[e._v(e._s(s.realName))])})],2)])]),e._v(" "),t("ul",{staticClass:"sales-select-btn"},[t("li",[t("zs-button",{attrs:{type:"cancel"},on:{click:e.handleCancelSetSales}},[e._v("取消")])],1),e._v(" "),t("li",[t("zs-button",{attrs:{type:"primary"},on:{click:e.handleConfirmSetSales}},[e._v("确认")])],1)])])],1)},staticRenderFns:[]}},32:function(e,s){e.exports={render:function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{directives:[{name:"clickoutside",rawName:"v-clickoutside",value:e.handleBlur,expression:"handleBlur"}],staticClass:"search__wrap",class:[{"is-focus":e.isFocus,"has-title":e.title}]},[e.title?t("p",{staticClass:"search-title"},[e._v(e._s(e.title))]):e._e(),e._v(" "),t("div",{staticClass:"search-input__wrap",class:[{"is-focus":e.isFocus}]},[t("div",{staticClass:"search-input__inner"},[t("i",{staticClass:"search-input-icon"}),e._v(" "),t("div",[t("zs-input",{staticClass:"search-input",attrs:{placeholder:e.placeholder,icon:"circle-cross"},on:{focus:e.handleFocus,enter:e.handleControl},model:{value:e.keyWord,callback:function(s){e.keyWord=s},expression:"keyWord"}})],1)])]),e._v(" "),t("p",{directives:[{name:"show",rawName:"v-show",value:e.isFocus,expression:"isFocus"}],staticClass:"search-input-control",on:{click:e.handleControl}},[e._v("搜索")])])},staticRenderFns:[]}},35:function(e,s){},358:function(e,s){},495:function(e,s,t){e.exports=t(92)},92:function(e,s,t){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var a=t(1),i=t(265),n=t.n(i),o=t(5),l=(t.n(o),t(3),t(4));a.a.use(l.a),new a.a({el:"#app",render:function(e){return e(n.a)}})}},[495]);