webpackJsonp([6],{177:function(e,a,s){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var t=s(2),i=s(6),n=s.n(i),o=s(9),r=s.n(o),l=s(30),c=s.n(l),d=s(29),u=s.n(d);a.default={components:{maHead:n.a,carNumber:r.a,upload:c.a,swiper:u.a},data:function(){return{id:"",state:"",isLoading:!1,canSubmit:!0,orderTimer:null,currTab:0,showAll:!1,payCashPopVisible:!1,payWechatPopVisible:!1,finalData:{createTime:"",businessPackage:{packageName:"",packageAndItems:[]},user:{mobile:"",realName:"",cars:[]}}}},computed:{userCarNum:function(){for(var e=this,a=[],s=0;s<this.finalData.user.cars.length;s++)a.push(e.finalData.user.cars[s].carNumber);return a.join(",")||""},realTotalPrice:function(){var e=this.finalData.totalAmount;return(e>0?parseFloat(e):0).toFixed(2)}},watch:{},methods:{getData:function(){var e=this;this.$ajax(this.$joggle.merchant.businessPackage.selectBusinessPackageOrderById,{id:this.id},!0,function(a,s){s.close(),"ZS011000"===a.code?a.data&&5!=a.data.state?(e.finalData=a.data,e.state=a.data.state):(e.$message({type:"error",message:"该订单不存在",duration:1200}),setTimeout(function(){history.go(-1)},1200)):e.$message({type:"error",message:a.msg,duration:1200})})},handleGoHome:function(){s.i(t.d)("/wap/merchant/home/manage/index.html")},handleLeftClick:function(){var e=this;this.$confirm({type:"order",message:"是否取消该订单?"}).then(function(){e.deleteOrder()}).catch(function(){})},handleMiddleClick:function(){this.payCashPopVisible=!0},handleRightClick:function(){this.payWechatPopVisible=!0,this.showBarCode()},showBarCode:function(){var e=this;s.i(t.n)(this.$joggle.merchant.businessPackage.selectPackageOrderDeskPay+"?packageOrderId="+this.id,function(a){e.$refs.barCodeWrap.innerHTML="",e.$refs.barCodeWrap.appendChild(a),clearInterval(e.orderTimer),e.orderTimer=setInterval(function(){e.isPaySuccess(function(){e.payWechatPopVisible=!1,clearInterval(e.orderTimer),e.getData(),e.$message({type:"success",message:"支付成功",duration:1200})})},2e3)})},isPaySuccess:function(e,a){var s=this;this.$ajax(this.$joggle.merchant.businessPackage.selectBusinessPackageOrderById,{id:this.id},!1,function(t){"ZS011000"===t.code?2==t.data.state?(s.finalData=t.data,e&&e()):a&&a():s.$message({type:"error",message:t.msg,duration:1200})})},deleteOrder:function(){var e=this;this.$ajax(this.$joggle.merchant.businessPackage.updateBusinessPackageOrderCancle,{businessPackageOrderId:this.id},!0,function(a,i){i.close(),"ZS011000"===a.code?(e.$message({type:"success",message:a.msg}),setTimeout(function(){s.i(t.d)("/wap/merchant/home/member/manage.html")},1200)):e.$message({type:"error",message:a.msg})})},finishOrder:function(){var e=this;this.$ajax(this.$joggle.merchant.workorder.updateWorkOrderForFinish,{orderId:this.finalData.id},!0,function(a,s){"ZS011000"===a.code?e.selectWorkOrder(function(){e.$message({type:"success",message:a.msg}),s.close()},s):(s.close(),e.$message({type:"error",message:a.msg}))})},handlePayCashConfirm:function(){var e=this;this.$ajax(this.$joggle.merchant.businessPackage.updateBusinessPackageOrderState,{id:this.id},!0,function(a,s){"ZS011000"===a.code?(e.getData(),e.payCashPopVisible=!1,e.$message({type:"success",message:a.msg})):(s.close(),e.$message({type:"error",message:a.msg}))})}},created:function(){if(this.id=s.i(t.a)("id")||"",s.i(t.c)(this.id))return this.$message({type:"error",message:"该套餐订单不存在"}),void(this.canSubmit=!1);this.getData()}}},25:function(e,a,s){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var t=s(13);a.default={name:"UploadPhoto",props:{reset:Boolean,images:{type:Array,default:function(){return[]}},max:{type:[Number,String],default:6}},data:function(){return{}},computed:{isFull:function(){return this.images.length>=this.max}},methods:{handlePushImg:function(e){var a=this;s.i(t.a)(e.target,600,function(s){a.isFull||(a.$emit("change",s.slice(23)),e.target.value="")})},handleDelImg:function(e,a){var s=this;this.$confirm({type:"delete2",message:"确认删除该图片？"}).then(function(){s.$emit("delete",e,a)}).catch(function(){})},handleView:function(e){this.$emit("view",e)}}}},252:function(e,a,s){s(350);var t=s(0)(s(177),s(273),null,null);e.exports=t.exports},273:function(e,a,s){e.exports={render:function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{directives:[{name:"show",rawName:"v-show",value:!e.isLoading,expression:"!isLoading"}],staticClass:"workorder-page"},[t("ma-head",{on:{"home-click":e.handleGoHome}},[e._v("套餐订单详情")]),e._v(" "),t("div",{staticClass:"workorder-second-page",class:[{pb10:2==e.state}]},[t("div",{staticClass:"member-info-box"},[t("ul",{staticClass:"member-info"},[t("li",{staticClass:"order-state-label"},[t("zs-icon",{attrs:{icon:["","nopay","finish"][e.state],size:"40","icon-dis":"15",text:["","待支付","已收款"][e.state]}})],1),e._v(" "),t("li",[t("span",{staticClass:"title"},[e._v("手机号")]),e._v(" "),t("p",{staticClass:"info"},[t("span",[e._v(e._s(e.finalData.user.mobile))])])]),e._v(" "),t("li",[t("span",{staticClass:"title"},[e._v("姓名")]),e._v(" "),t("p",{staticClass:"info"},[t("span",[e._v(e._s(e.finalData.user.realName))])])]),e._v(" "),t("li",[t("span",{staticClass:"title"},[e._v("绑定车辆")]),e._v(" "),t("p",{staticClass:"info text-hide"},[e._v("\n                        "+e._s(e.userCarNum)+"\n                    ")])])])]),e._v(" "),t("div",{staticClass:"package-detail"},[t("p",{staticClass:"package-detail-title"},[t("zs-icon",{attrs:{icon:"pack",size:25,text:"套餐信息"}})],1),e._v(" "),t("div",{staticClass:"package-info"},[t("ul",{staticClass:"open-package-list"},[t("li",{staticClass:"item",class:["","use-up","time-out"][e.currTab-1]},[t("div",{staticClass:"item-head"},[t("p",{staticClass:"head-info"},[e._v("\n                                "+e._s(e.finalData.businessPackage.packageName)+"\n                            ")]),e._v(" "),t("p",{staticClass:"head-info"},[t("span",{staticClass:"item-name"},[e._v("金额"),t("i",[e._v("￥"+e._s(e.finalData.totalAmount||""))])]),e._v(" "),t("span",{staticClass:"item-validate"},[t("zs-icon",{staticClass:"item-merchant",attrs:{icon:"time","icon-dis":"6",text:0!=e.finalData.businessPackage.validTerm?"有效期："+e.finalData.businessPackage.validTerm+"年":"有效期：永久"}})],1)])]),e._v(" "),t("div",{staticClass:"service-info"},e._l(e.finalData.businessPackage.packageAndItems,function(a,s){return t("p",{directives:[{name:"show",rawName:"v-show",value:s<3||e.showAll,expression:"index < 3 || showAll"}],key:a.id},[e._v("\n                                "+e._s(a.serviceItem.itemName)+"\n                                "),t("span",{staticClass:"r"},[e._v("×"+e._s(a.useTimes))])])})),e._v(" "),t("p",{directives:[{name:"show",rawName:"v-show",value:e.finalData.businessPackage.packageAndItems.length>3&&!e.showAll,expression:"finalData.businessPackage.packageAndItems.length>3 && !showAll"}],staticClass:"show-more-item",on:{click:function(a){e.showAll=!0}}},[e._v("\n                            查看更多")])])])])]),e._v(" "),t("div",{staticClass:"order-info"},[t("div",{staticClass:"order-info-item"},[t("div",{staticClass:"order-info-item-left"},[e._v("\n                    订单编号\n                ")]),e._v(" "),t("div",{staticClass:"order-info-item-right"},[e._v("\n                    "+e._s(e.finalData.orderNumber)+"\n                ")])]),e._v(" "),t("div",{staticClass:"order-info-item"},[t("div",{staticClass:"order-info-item-left"},[e._v("\n                    新建时间\n                ")]),e._v(" "),t("div",{staticClass:"order-info-item-right"},[e._v("\n                    "+e._s(e.finalData.createTime)+"\n                ")])]),e._v(" "),2==e.state?t("div",{staticClass:"order-info-item"},[t("div",{staticClass:"order-info-item-left"},[e._v("\n                    收款时间\n                ")]),e._v(" "),t("div",{staticClass:"order-info-item-right"},[e._v("\n                    "+e._s(e.finalData.updateTime)+"\n                ")])]):e._e()]),e._v(" "),1==e.state?t("ul",{staticClass:"workorder-page-footer"},[t("li",{staticClass:"left bg-white",on:{click:e.handleLeftClick}},[e._v("取消订单\n            ")]),e._v(" "),t("li",{staticClass:"left",on:{click:e.handleMiddleClick}},[e._v("现金收款\n            ")]),e._v(" "),t("li",{staticClass:"right",on:{click:e.handleRightClick}},[e._v("微信收款\n            ")])]):e._e()]),e._v(" "),t("zs-dialog",{staticClass:"settle-pop",attrs:{"show-close":""},model:{value:e.payCashPopVisible,callback:function(a){e.payCashPopVisible=a},expression:"payCashPopVisible"}},[t("p",{slot:"title"},[t("zs-icon",{attrs:{icon:"nopay",size:"24","icon-dis":"8",text:"现金收款"}})],1),e._v(" "),t("p",{staticClass:"pay-pop-p1"},[e._v("￥ "+e._s(e.realTotalPrice))]),e._v(" "),t("p",{staticClass:"pay-pop-p2"},[e._v("是否收到现金或刷卡支付?")]),e._v(" "),t("ul",{staticClass:"pay-pop-control",slot:"footer"},[t("li",[t("zs-button",{on:{click:function(a){e.payCashPopVisible=!1}}},[e._v("取消")])],1),e._v(" "),t("li",[t("zs-button",{on:{click:e.handlePayCashConfirm}},[e._v("确定收款")])],1)])]),e._v(" "),t("zs-dialog",{staticClass:"settle-pop wechat-pay-pop",model:{value:e.payWechatPopVisible,callback:function(a){e.payWechatPopVisible=a},expression:"payWechatPopVisible"}},[t("p",{slot:"title"},[t("zs-icon",{attrs:{icon:"wechat-pay",size:"24","icon-dis":"8",text:"微信扫码付款"}})],1),e._v(" "),t("p",{ref:"barCodeWrap",staticClass:"pay-pop-barcode"},[t("img",{staticClass:"pay-pop-loading",attrs:{src:s(37)}})]),e._v(" "),t("p",{staticClass:"pay-pop-p1"},[e._v("￥ "+e._s(e.realTotalPrice))])])],1)},staticRenderFns:[]}},30:function(e,a,s){s(34);var t=s(0)(s(25),s(31),null,null);e.exports=t.exports},31:function(e,a){e.exports={render:function(){var e=this,a=e.$createElement,s=e._self._c||a;return s("ul",{staticClass:"upload-photo__wrap clr"},[e._l(e.images,function(a,t){return s("li",{on:{click:function(a){e.handleView(t)}}},[s("div",{staticClass:"image-label",style:{backgroundImage:"url('"+a.showImg+"')"}},[s("span",{staticClass:"image-del-icon",on:{click:function(s){s.stopPropagation(),e.handleDelImg(t,a.id)}}})])])}),e._v(" "),e.isFull?e._e():s("li",{staticClass:"upload-photo__btn"},[s("label",{staticClass:"image-label add-label",attrs:{for:"imgInput"}},[s("input",{staticClass:"imgInput",attrs:{id:"imgInput",type:"file",accept:"image/*"},on:{change:e.handlePushImg}})])])],2)},staticRenderFns:[]}},34:function(e,a){},350:function(e,a){},482:function(e,a,s){e.exports=s(79)},79:function(e,a,s){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var t=s(1),i=s(252),n=s.n(i),o=s(5),r=(s.n(o),s(3),s(4));t.a.use(r.a),new t.a({el:"#app",render:function(e){return e(n.a)}})}},[482]);