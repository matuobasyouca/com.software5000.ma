webpackJsonp([46],{149:function(t,a,s){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var e=s(6),i=s.n(e),n=s(9),c=s.n(n),o=s(2),r=s(8),u=s(7);a.default={components:{carNumber:c.a,maHead:i.a},data:function(){return{openId:"",id:"",shareModel:!1,payState:"",countdown:0,activityState:0,groupState:0,groupData:{},packClusterData:{businessPackage:{packageAndItems:[]}},shareDescription:"",packageAndItems:[],businessName:""}},computed:{packageItemText:function(){var t="";if(!s.i(o.c)(this.packageAndItems)){for(var a=this.packageAndItems.packageAndItems,e=0;e<a.length;e++)t+=a[e].serviceItem.itemName+" *"+a[e].useTimes+"、";t=t.substring(0,t.length-1)}return t},handCountdownH:function(){var t=parseInt(this.countdown/60/60);return(t=t>9?t+"":"0"+t)||"00"},handCountdownM:function(){var t=parseInt(this.countdown/60%60);return(t=t>9?t+"":"0"+t)||"00"},handCountdownS:function(){var t=this.countdown%60;return(t=t>9?t+"":"0"+t)||"00"}},methods:{handGoBack:function(){s.i(o.d)("/wap/customer/open/group/list.html",{i:r.a.encode(this.openId)})},getData:function(t){var a=this,s={openId:this.openId,packClusterBuyRecordId:this.id};6==this.payState&&(s.payState=6),this.$ajax(this.$joggle.customer.packcluster.selectPackClusterBuyRecordDetail,s,!1,function(s){if("ZS011000"===s.code){a.groupData=s.data,a.packClusterData=s.data.packCluster,a.shareDescription=s.data.packCluster.shareDescription;var e=o.g.dateToRegular(s.data.serviceTime).getTime(),i=o.g.dateToRegular(s.data.endDay).getTime();a.handRemainingTime(e,i);var n=new Promise(function(t){a.handleBusinessName(function(){t()},a.groupData.packCluster.packId)}),c=new Promise(function(t){a.handleBusinessId(function(){t()},a.groupData.packCluster.businessId)});Promise.all([n,c]).then(function(){t&&t()})}else a.$message({type:"error",message:s.msg,duration:1200})})},handleBusinessName:function(t,a){var s=this;this.$ajax(this.$joggle.customer.packcluster.selectBusinessPackageForOpenEmkt,{packIds:a},!1,function(e){"ZS011000"===e.code?s.packageAndItems=e.data[a]:s.$message({type:"error",message:e.msg}),t&&t()})},handRemainingTime:function(t,a){var s=this,e=a;if(e>t){this.countdown=parseInt((e-t)/1e3);var i=setInterval(function(){s.countdown>0?s.countdown--:(clearInterval(i),s.groupData.openState=4)},1e3)}},handleBusinessId:function(t,a){var s=this;this.$ajax(this.$joggle.customer.packcluster.selectEnableBusinessNameList,{businessIds:a+""},!0,function(e,i){"ZS011000"===e.code?s.businessName=e.data[a].businessName:(i.close(),s.$message({type:"error",message:e.msg,duration:"1000"})),t&&t()})},setWxConfig:function(t){var a=this;this.$ajax(this.$joggle.open.selectWxJsAPI,{url:window.location.href},!1,function(s){if("ZS011000"===s.code){var e="【仅剩"+(a.packClusterData.clusterNum-a.packClusterData.successNum)+"个名额】 "+a.packClusterData.clusterName,i=a.shareDescription,n=window.location.host,c="http://"+n+"/wap/customer/open/group/activity.html?id="+a.packClusterData.id+"&openRecordId="+a.id,o=a.packClusterData.shareImgPath?a.packClusterData.shareImgPathUrl:a.groupData.imgSrc;wx.config({debug:!1,appId:s.data.appId,timestamp:s.data.timestamp,nonceStr:s.data.nonce,signature:s.data.signature,jsApiList:["checkJsApi","onMenuShareTimeline","onMenuShareAppMessage"]}),wx.ready(function(t){wx.checkJsApi({jsApiList:["onMenuShareTimeline","onMenuShareAppMessage"],success:function(t){},error:function(t){}}),wx.onMenuShareTimeline({title:e,desc:i,link:c,imgUrl:o,type:"link",success:function(){},cancel:function(t){},error:function(t){}}),wx.onMenuShareAppMessage({title:e,desc:i,link:c,imgUrl:o,type:"link"})}),wx.error(function(t){}),t&&t()}else a.$message({type:"error",message:s.msg,duration:1200})})}},created:function(){var t=this;this.openId=s.i(o.a)("i")?r.a.decode(s.i(o.a)("i")):"",this.id=s.i(o.a)("id")||"",this.payState=s.i(o.a)("payState")||"",this.shareModel=!!s.i(o.a)("showShare"),this.openId&&this.id||(this.$message({type:"error",message:"请从正常路径进入页面",duration:"1000"}),setTimeout(function(){s.i(u.a)("/wap/open/customer/detail_user.html","emkt")},1e3));var a=this.$loading();this.getData(function(){1==t.groupData.openState&&0==t.countdown&&(t.groupData.openState=4),1==t.groupData.openState?t.setWxConfig(function(){a.close()}):a.close()})}}},224:function(t,a,s){s(409);var e=s(0)(s(149),s(342),null,null);t.exports=e.exports},342:function(t,a){t.exports={render:function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("div",{staticClass:"page"},[s("div",{staticClass:"page-top group-state"},[s("zs-icon",{staticClass:"icon-back",attrs:{size:12,icon:"arrow-left"},on:{click:t.handGoBack}}),t._v(" "),s("div",{staticClass:"page-top-main",class:["","grouping","success","fail","fail"][t.groupData.openState||"1"]},[s("div",{staticClass:"state-top"},[s("zs-icon",{attrs:{icon:["","group-grouping","group-success","group-fail","group-fail"][t.groupData.openState||"1"],size:60}})],1),t._v(" "),s("div",{staticClass:"state-text"},[t._v(t._s(["","拼团中","拼团成功","拼团失败","拼团失败"][t.groupData.openState||"1"]))]),t._v(" "),2==t.groupData.openState?s("div",{staticClass:"state-over"},[t._v("\n                "+t._s(t.packClusterData.clusterNum)+"人团\n            ")]):t._e(),t._v(" "),3==t.groupData.openState||4==t.groupData.openState?s("div",{staticClass:"state-over"},[t._v("\n                "+t._s(t.packClusterData.successNum)+"人参与拼团，差"+t._s(t.packClusterData.clusterNum-t.packClusterData.successNum)+"人\n            ")]):t._e()]),t._v(" "),1==t.groupData.openState&&t.countdown?s("div",{staticClass:"state-time"},[s("div",{staticClass:"countdown"},[s("i",{staticClass:"red-block"},[s("span",[t._v(t._s(t.handCountdownH.substring(0,1)))])]),t._v(" "),s("i",{staticClass:"red-block"},[s("span",[t._v(t._s(t.handCountdownH.substring(1)))])]),t._v(" "),s("span",{staticClass:"maohao"},[t._v(":")]),t._v(" "),s("i",{staticClass:"red-block"},[s("span",[t._v(t._s(t.handCountdownM.substring(0,1)))])]),t._v(" "),s("i",{staticClass:"red-block"},[s("span",[t._v(t._s(t.handCountdownM.substring(1)))])]),t._v(" "),s("span",{staticClass:"maohao"},[t._v(":")]),t._v(" "),s("i",{staticClass:"red-block"},[s("span",[t._v(t._s(t.handCountdownS.substring(0,1)))])]),t._v(" "),s("i",{staticClass:"red-block"},[s("span",[t._v(t._s(t.handCountdownS.substring(1)))])])])]):t._e()],1),t._v(" "),s("div",{staticClass:"package-main"},[s("div",{staticClass:"store-name"},[s("zs-icon",{attrs:{size:15,icon:"shang3",text:t.businessName}}),t._v(" "),3==t.groupData.openState||4==t.groupData.openState?s("div",{staticClass:"r"},[t._v("\n                "+t._s(["已退款","退款中"][t.groupData.openState-3||0])+"\n            ")]):t._e()],1),t._v(" "),s("div",{staticClass:"package"},[t.groupData.openState?s("div",{staticClass:"package-left",style:"background-image: url("+(t.packClusterData.shareImgPath?t.packClusterData.shareImgPathUrl:t.groupData.imgSrc)+")"}):t._e(),t._v(" "),s("div",{staticClass:"package-right"},[s("div",{staticClass:"package-date"},[t._v("\n                    "+t._s(t.packageAndItems.packageName)+"(有效期"+t._s(0!=t.packageAndItems.validTerm?t.packageAndItems.validTerm+"年":"永久")+")\n                ")]),t._v(" "),s("div",{staticClass:"package-price"},[s("p",{staticClass:"original"},[t._v("\n                        报团价"),s("span",{staticClass:"red"},[t._v("￥"+t._s(t.packClusterData.salePrice))])]),t._v(" "),s("p",{staticClass:"del"},[t._v("\n                        原价:￥"+t._s(t.packageAndItems.salePrice)+"\n                    ")])])])]),t._v(" "),s("div",{staticClass:"package-item"},[s("div",{staticClass:"package-item-table clr"},[t._l(t.packageAndItems.packageAndItems,function(a,e){return s("div",{key:e,staticClass:"package-item-table-td"},[s("div",{staticClass:"item-table-td-left"},[t._v("\n                        "+t._s(a.serviceItem.itemName)+"\n                    ")]),t._v(" "),s("div",{staticClass:"item-table-td-right"},[t._v("\n                        "+t._s(a.useTimes)+"\n                    ")])])}),t._v(" "),t.packageAndItems.packageAndItems.length%2==1?s("div",{staticClass:"package-item-table-td"},[s("div",{staticClass:"item-table-td-left"},[t._v("\n                         \n                    ")]),t._v(" "),s("div",{staticClass:"item-table-td-right"},[t._v("\n                         \n                    ")])]):t._e()],2)])]),t._v(" "),s("div",{staticClass:"details-info-1"},[s("div",{staticClass:"item"},[s("div",{staticClass:"item-left"},[t._v("\n                手机号\n            ")]),t._v(" "),s("div",{staticClass:"item-right"},[t._v("\n                "+t._s(t.groupData.mobile)+"\n            ")])]),t._v(" "),s("div",{staticClass:"item"},[s("div",{staticClass:"item-left"},[t._v("\n                车牌号\n            ")]),t._v(" "),s("div",{staticClass:"item-right"},[t._v("\n                "+t._s(t.groupData.carNumber)+"\n            ")])])]),t._v(" "),s("div",{staticClass:"details-info-2"},[s("ul",{staticClass:"info-2-top"},[s("li",[s("div",{staticClass:"top-left"},[t._v("订单编号")]),t._v(" "),s("div",{staticClass:"top-right"},[t._v(t._s(t.groupData.orderNo))])]),t._v(" "),s("li",[s("div",{staticClass:"top-left"},[t._v("下单时间")]),t._v(" "),s("div",{staticClass:"top-right"},[t._v(t._s(t.groupData.createTime))])]),t._v(" "),s("li",[s("div",{staticClass:"top-left"},[t._v("支付时间")]),t._v(" "),s("div",{staticClass:"top-right"},[t._v(t._s(t.groupData.payTime))])]),t._v(" "),3==t.groupData.openState?s("li",[s("div",{staticClass:"top-left"},[t._v("退款时间")]),t._v(" "),s("div",{staticClass:"top-right"},[t._v(t._s(t.groupData.updateTime))])]):t._e()]),t._v(" "),s("div",{staticClass:"notice"},[t._v("\n            拼团须知\n            "),s("div",{staticClass:"r"},[s("zs-icon",{attrs:{size:16,icon:"user2",text:"好友拼单"}}),t._v(" "),s("zs-icon",{attrs:{size:16,icon:"check3",text:"人满成功"}}),t._v(" "),s("zs-icon",{attrs:{size:16,icon:"cash-pay2",text:"人不满退款"}})],1)])]),t._v(" "),t.shareModel?s("div",{staticClass:"share-model",on:{click:function(a){t.shareModel=!1}}},[s("div",{staticClass:"share-body"},[s("zs-icon",{staticClass:"guide-arrow-icon",attrs:{icon:"guide-arrow",size:"100"}}),t._v(" "),s("div",{staticClass:"body-main"},[s("p",[t._v("还差"+t._s(t.packClusterData.clusterNum-t.packClusterData.successNum)+"人")]),t._v(" "),s("p",[t._v("点击右上角发送给朋友")])])],1)]):t._e(),t._v(" "),1==t.groupData.openState?s("div",{staticClass:"footer"},[s("div",{staticClass:"footer-main",on:{click:function(a){t.shareModel=!0}}},[t._v("\n            邀请好友拼单\n        ")])]):t._e()])},staticRenderFns:[]}},409:function(t,a){},455:function(t,a,s){t.exports=s(52)},52:function(t,a,s){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var e=s(1),i=s(224),n=s.n(i),c=s(5),o=(s.n(c),s(3),s(4));e.a.use(o.a),new e.a({el:"#app",render:function(t){return t(n.a)}})}},[455]);