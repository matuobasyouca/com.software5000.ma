webpackJsonp([49],{145:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(6),s=a.n(r),i=a(2),o=a(7),n=a(10);t.default={components:{maHead:s.a},data:function(){return{isLoading:!0,payOrderId:"",code:"",orderTitle:"",totalPrice:"",orderService:"",orderDetails:"",orderContent:"",orderNo:"",appId:"",timeStamp:"",nonceStr:"",packagevar:"",paySign:"",subscribe:0,nextUrl:"",canPay:!1}},computed:{showGoBack:function(){return"诚品套餐支付"===this.orderTitle?"arrow-left":""}},methods:{selectWxParams:function(e,t){var r=this;this.$ajax(this.$joggle.customer.cashier.unifiedOrder,{payOrderId:parseInt(this.payOrderId),code:this.code},t,function(t,s){"ZS011000"===t.code?(r.appId=t.data.appId,r.timeStamp=""+t.data.timeStamp,r.nonceStr=t.data.nonceStr,r.packagevar="prepay_id="+t.data.packagevar,r.paySign=t.data.paySign,r.canPay=!0,r.appId&&e&&e(),r.subscribe=t.data.subscribe):"ZS012042"===t.code?a.i(n.c)():(s.close(),r.$message({type:"error",message:t.msg}))})},selectPayOrder:function(e,t){var r=this;this.$ajax(this.$joggle.customer.cashier.selectPayOrder,{payOrderId:this.payOrderId},t,function(t,s){if(s.close(),"ZS011000"===t.code){if(a.i(i.c)(t.data))return void setTimeout(function(){a.i(o.a)("/wap/open/customer/detail_user.html","emkt")},1e3);r.orderTitle=t.data.orderTitle,r.totalPrice=t.data.totalPrice,r.orderService=t.data.orderService,r.orderDetails=t.data.orderDetail?a.i(i.j)(t.data.orderDetail):"",r.orderContent=t.data.orderContent,r.orderNo=t.data.orderNo,r.nextUrl=t.data.redirectUrl,e&&e()}else r.$message({type:"error",message:t.msg})})},checkPay:function(e,t){var r=this;this.$ajax(this.$joggle.customer.cashier.checkPay,{orderNo:this.orderNo},t,function(t){"ZS011000"===t.code?e&&e():(r.$message({type:"error",message:t.msg,duration:1e3}),setTimeout(function(){a.i(o.a)("/wap/open/customer/detail_user.html","emkt")},1e3))})},handlePay:function(){var e=this;if(this.canPay){var t=this.$loading(),r=this;this.checkPay(function(){WeixinJSBridge.invoke("getBrandWCPayRequest",{appId:e.appId,timeStamp:e.timeStamp,nonceStr:e.nonceStr,package:e.packagevar,signType:"MD5",paySign:e.paySign},function(e){t.close(),"get_brand_wcpay_request:ok"===e.err_msg?a.i(i.c)(r.nextUrl)?0==r.subscribe?a.i(i.d)("/wap/customer/open/scan.html"):a.i(o.a)("/wap/open/customer/detail_user.html","emkt"):r.nextUrl.indexOf("?")>-1?a.i(i.d)(r.nextUrl+"&orderNo="+this.orderNo+"&subscribe="+this.subscribe):a.i(i.d)(r.nextUrl,{orderNo:r.orderNo,subscribe:r.subscribe}):"get_brand_wcpay_request:cancel"===e.err_msg?r.$message({type:"error",message:"取消付款"}):r.message({type:"error",message:"付款失败"})})},t)}}},created:function(){var e=this;if(this.payOrderId=a.i(i.a)("payOrderId")||"",a.i(i.c)(this.payOrderId))return this.$message({type:"error",message:"订单不存在"}),void setTimeout(function(){a.i(o.a)("/wap/open/customer/detail_user.html","emkt")},1e3);a.i(n.a)(function(t){e.code=t;var a=e.$loading(),r=new Promise(function(t){e.selectPayOrder(function(){t()},a)}),s=new Promise(function(t){e.selectWxParams(function(){t()},a)});Promise.all([r,s]).then(function(){a.close(),e.isLoading=!1})})}}},220:function(e,t,a){a(385);var r=a(0)(a(145),a(314),null,null);e.exports=r.exports},314:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"show",rawName:"v-show",value:!e.isLoading,expression:"!isLoading"}],staticClass:"cashier-page"},[a("ma-head",{attrs:{"left-icon":e.showGoBack,home:!1}},[e._v(e._s(e.orderTitle))]),e._v(" "),a("div",{staticClass:"cashier-info"},[a("p",{staticClass:"cashier-item"},[e._v("应付款 "),a("span",[e._v("￥"+e._s(e.totalPrice/100))])]),e._v(" "),a("p",{staticClass:"cashier-item"},[e._v("服务信息 "),a("span",[e._v(e._s(e.orderService))])])]),e._v(" "),e.orderDetails.length>0?a("div",{staticClass:"cashier-detail"},[a("h3",{staticClass:"cashier-block-title"},[e._v("明细")]),e._v(" "),a("ul",{staticClass:"cashier-detail-list"},e._l(e.orderDetails,function(t){return a("li",{staticClass:"cashier-item"},[e._v("\n                "+e._s(t.dk)+" "),a("span",[e._v(e._s(t.dv))])])}))]):e._e(),e._v(" "),e.orderContent?a("div",{staticClass:"cashier-instruction"},[a("h3",{staticClass:"cashier-block-title"},[e._v("说明")]),e._v(" "),a("p",{staticClass:"cashier-instruction-main",domProps:{innerHTML:e._s(e.orderContent)}})]):e._e(),e._v(" "),a("div",{staticClass:"cashier-button",on:{click:e.handlePay}},[e._v("微信支付")])],1)},staticRenderFns:[]}},385:function(e,t){},451:function(e,t,a){e.exports=a(48)},48:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(1),s=a(220),i=a.n(s),o=a(5),n=(a.n(o),a(3),a(4));r.a.use(n.a),new r.a({el:"#app",render:function(e){return e(i.a)}})}},[451]);