webpackJsonp([0],{152:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=i(9),r=i.n(s),o=i(2),a=i(7);e.default={components:{carNumber:r.a},data:function(){return{index:-1,count:8,timer:null,speed:20,times:0,cycle:50,prize:-1,realPrize:"",remain:0,hasClick:!1,list:[{i:0,img:i(420),show:i(421),name:"免费清洗空调一次"},{i:1,img:i(422),show:i(423),name:"手机支架"},{i:2,img:i(424),show:i(425),name:"10元现金券"},{i:7,img:i(434),show:i(435),name:"二维码停车贴"},{i:-1},{i:3,img:i(426),show:i(427),name:"免费洗车一次"},{i:6,img:i(432),show:i(433),name:"10元现金券"},{i:5,img:i(430),show:i(431),name:"手机支架"},{i:4,img:i(428),show:i(429),name:"二维码停车贴"}],prizeIdMap:{0:[0],1:[3],2:[2,6],3:[1,5],4:[4,7]},bgToggle:!1,onTouch:!1,prizePop1:!1,prizePop2:!1,mobile:"",carNumber:"",tradeNo:"",isLoading:!0}},computed:{setCarProvince:function(){return this.carNumber[0]||""},setCarLetter:function(){return this.carNumber[1]||""},setCarNum:function(){return i.i(o.c)(this.carNumber)?"":this.carNumber.slice(2)}},watch:{prizePop1:function(t){this.hasClick=t},prizePop2:function(t){this.hasClick=t}},methods:{getList:function(t){return this["list"+t]},setActive:function(){++this.index>this.count-1&&(this.index=0)},roll:function(){this.times++,this.setActive(),this.times>this.cycle+10&&this.prize==this.index?(clearTimeout(this.timer),this.timer=null,this.speed=20,this.prize=-1,this.times=0,setTimeout(this.handleNotice,600)):(this.times<this.cycle?this.speed-=10:this.times==this.cycle?this.prize=this.realPrize:this.times>this.cycle+10&&(0==this.prize&&4==this.index||this.prize==this.index+1)?this.speed+=110:this.speed+=20,this.speed<40&&(this.speed=40),this.timer=setTimeout(this.roll,this.speed))},handleStart:function(t){var e=this;t>-1||this.remain<1||this.hasClick||this.getRealPrize(function(){e.remain--,e.speed=150,e.hasClick=!0,e.roll()})},jumpToNext:function(){this.prizePop1=!1,0==this.subscribe?i.i(o.d)("/wap/customer/open/scan.html"):i.i(a.a)("/wap/open/customer/detail_user.html","emkt")},selectTimes:function(t){var e=this;this.$ajax(this.$joggle.customer.lottery.selectLotteryTimes,{id:this.payOrderId},!0,function(s,r){if(r.close(),"ZS011000"===s.code){if(i.i(o.c)(s.data))return void(e.remain=0);e.remain=s.data.lotteryTimes,e.carNumber=i.i(o.c)(s.data.carNumber)?"":s.data.carNumber,e.mobile=i.i(o.c)(s.data.mobile)?"":s.data.mobile,t&&t(s.data)}else e.$message({type:"error",message:"操作失败"})})},getRealPrize:function(t){var e=this;this.$ajax(this.$joggle.customer.lottery.selectPrize,{id:this.payOrderId,mobile:this.mobile,carNumber:this.carNumber},!0,function(i,s){if(s.close(),"ZS011000"===i.code){var r=i.data;e.realPrize=e.prizeIdMap[r].sort(function(){return Math.random()-.5})[0],t&&t()}else e.$messsage({type:"error",message:"操作失败"})})},handleNotice:function(){[1,4,5,7].indexOf(this.realPrize)>-1?this.prizePop1=!0:[0,2,3,6].indexOf(this.realPrize)>-1&&(this.prizePop2=!0)},setPrize:function(){for(var t=this,e=0;e<this.list.length;e++)if(t.list[e].i==t.realPrize)return{name:t.list[e].name,show:t.list[e].show};return{}},handleGetCarNumber:function(t){this.carNumber=t},handleInfoConfirm:function(){var t=this;return i.i(o.i)(this.mobile)?i.i(o.h)(this.carNumber)?void this.$ajax(this.$joggle.customer.lottery.CouponinsertUsed,{id:this.payOrderId,carNumber:this.carNumber,mobile:this.mobile},!0,function(e,i){i.close(),"ZS011000"===e.code?(t.$message({type:"success",message:"领取成功"}),t.prizePop2=!1,t.jumpToNext()):t.$message({type:"error",message:"操作失败"})}):void this.$message({type:"error",message:"车牌号码有误!"}):void this.$message({type:"error",message:"手机号码有误!"})}},created:function(){var t=this;this.payOrderId=i.i(o.a)("id")||"",this.subscribe=i.i(o.a)("subscribe")||"",this.selectTimes(function(e){1==e.receiveState&&(t.realPrize=t.prizeIdMap[e.prizeNum].sort(function(){return Math.random()-.5})[0],t.handleNotice()),t.isLoading=!1}),setInterval(function(){t.bgToggle=!t.bgToggle},300)}}},227:function(t,e,i){i(380);var s=i(0)(i(152),i(307),null,null);t.exports=s.exports},307:function(t,e,i){t.exports={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{directives:[{name:"show",rawName:"v-show",value:!t.isLoading,expression:"!isLoading"}],staticClass:"lottery-page"},[s("div",{staticClass:"lottery-head"},[t._v("\n        支付成功"),s("span",{on:{click:t.jumpToNext}},[t._v("跳过")])]),t._v(" "),s("img",{staticClass:"lottery-title",attrs:{src:i(436)}}),t._v(" "),s("div",{staticClass:"lottery-roll-wrap"},[s("div",{staticClass:"background",class:[{bg2:t.bgToggle}]},[s("ul",{staticClass:"list-wrap"},t._l(t.list,function(e){return s("li",{key:e.i,on:{click:function(i){t.handleStart(e.i)}}},[-1!=e.i?s("div",{staticClass:"image",class:[{active:e.i==t.index,modal:t.hasClick}],style:{backgroundImage:"url('"+e.img+"')"}}):s("p",{class:[{"start-control":-1==e.i,"on-press":t.onTouch}],on:{touchstart:function(e){!t.hasClick&&(t.onTouch=!0)},touchend:function(e){t.onTouch=!1}}},[s("span",[t._v("(共"+t._s(t.remain)+"次机会)")])])])}))])]),t._v(" "),t._m(0),t._v(" "),s("zs-dialog",{staticClass:"prize-pop",attrs:{"show-close":!1,"close-on-click-modal":!1},model:{value:t.prizePop1,callback:function(e){t.prizePop1=e},expression:"prizePop1"}},[s("p",{slot:"title"},[t._v("恭喜您，您抽中"+t._s(t.setPrize().name))]),t._v(" "),s("div",{staticClass:"prize-pop-show",style:{backgroundImage:"url("+t.setPrize().show+")"}}),t._v(" "),s("p",{staticClass:"prize-pop-notice"},[t._v("请与店铺老板兑换奖品")]),t._v(" "),s("p",{staticClass:"prize-pop-notice1"},[t._v("注：将此页面提供给老板核实奖品")]),t._v(" "),s("div",{staticClass:"prize-confirm-btn",on:{click:t.jumpToNext}},[t._v("确定")])]),t._v(" "),s("zs-dialog",{staticClass:"prize-pop prize-coupon-pop",attrs:{"show-close":!1,"close-on-click-modal":!1},model:{value:t.prizePop2,callback:function(e){t.prizePop2=e},expression:"prizePop2"}},[s("p",{slot:"title"},[t._v("恭喜您，您抽中"+t._s(t.setPrize().name))]),t._v(" "),s("zs-input",{staticClass:"lottery-mobile",attrs:{type:"tel",maxlength:11,placeholder:"请输入手机号码",icon:"circle-cross"},model:{value:t.mobile,callback:function(e){t.mobile=e},expression:"mobile"}}),t._v(" "),s("car-number",{attrs:{carProvince:t.setCarProvince,carLetter:t.setCarLetter,carNum:t.setCarNum},on:{"get-car-number":t.handleGetCarNumber}}),t._v(" "),s("div",{staticClass:"prize-confirm-btn",on:{click:t.handleInfoConfirm}},[t._v("确定")])],1)],1)},staticRenderFns:[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"lottery-instruction-wrap"},[i("div",{staticClass:"lottery-instruction"},[i("p",{staticClass:"instruction-title"}),t._v(" "),i("ul",{staticClass:"instruction-list"},[i("li",[t._v("1.您可点击抽奖进行抽奖")]),t._v(" "),i("li",[t._v("2.一二三等奖以优惠券形式发放到您账户")]),t._v(" "),i("li",[t._v("3.四五等奖请与店铺老板进行兑换")]),t._v(" "),i("li",[t._v("4.点击跳过表示您放弃本次抽奖")])])])])}]}},380:function(t,e){},420:function(t,e,i){t.exports=i.p+"static/img/0.9f0a72c.png"},421:function(t,e,i){t.exports=i.p+"static/img/0_.c5f4d70.jpg"},422:function(t,e,i){t.exports=i.p+"static/img/1.cfe05be.png"},423:function(t,e,i){t.exports=i.p+"static/img/1_.d26c8ca.jpg"},424:function(t,e,i){t.exports=i.p+"static/img/2.641dcb1.png"},425:function(t,e,i){t.exports=i.p+"static/img/2_.faa9fd8.jpg"},426:function(t,e,i){t.exports=i.p+"static/img/3.3d7b1c2.png"},427:function(t,e,i){t.exports=i.p+"static/img/3_.205b7d3.jpg"},428:function(t,e,i){t.exports=i.p+"static/img/4.9384d04.png"},429:function(t,e,i){t.exports=i.p+"static/img/4_.b9102bb.jpg"},430:function(t,e,i){t.exports=i.p+"static/img/5.00e28dd.png"},431:function(t,e,i){t.exports=i.p+"static/img/5_.d26c8ca.jpg"},432:function(t,e,i){t.exports=i.p+"static/img/6.641dcb1.png"},433:function(t,e,i){t.exports=i.p+"static/img/6_.faa9fd8.jpg"},434:function(t,e,i){t.exports=i.p+"static/img/7.9384d04.png"},435:function(t,e,i){t.exports=i.p+"static/img/7_.b9102bb.jpg"},436:function(t,e,i){t.exports=i.p+"static/img/title.9912474.png"},458:function(t,e,i){t.exports=i(55)},55:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=i(1),r=i(227),o=i.n(r),a=i(5),n=(i.n(a),i(3),i(4));s.a.use(n.a),new s.a({el:"#app",render:function(t){return t(o.a)}})}},[458]);