webpackJsonp([11],{169:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s(7),i=s.n(a),r=s(264),o=s.n(r),n=s(6),c=s.n(n);t.default={components:{maHead:c.a,list:o.a,tab:i.a},data:function(){return{}}}},170:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s(1);t.default={name:"list",data:function(){return{datas:[],context:this,columns:[{title:"服务项目",key:"itemName",align:"center",width:284},{title:"价格",key:"salePrice",align:"center",width:244},{title:"所属分类",key:"itemType",align:"center",width:254,render:function(e,t,s,a){var i="";for(var r in a.ServiceItemType)a.ServiceItemType[r][0]==e.itemType&&(i=a.ServiceItemType[r][1]);return i}},{title:"排序",key:"sort",align:"center",className:"item-times",width:220,render:function(e,t,s,a){return e.sortState?'<input\n                                    class="item-times"\n                                    type="number"\n                                    autofocus\n                                    key="'+e.id+'"\n                                    value="'+e.sort+'"\n                                    @focus="handleOldInsertItemTimes('+s+')"\n                                    @blur="handleCloseInsertItemTimes('+s+',$event)"\n                                    @change="handleChangeItemTimes('+s+',$event)">':'<p @click="handleOpenInsertItemTimes('+s+')">'+(e.sort?e.sort:"")+"</p>"}},{title:"操作",key:"topState",align:"center",className:"account-operation",width:250,render:function(e,t,s,a){return(1==e.topState?'<a class="istop" @click="isTop('+s+',0)">取消置顶</a>':'<a class="istop" @click="isTop('+s+',1)">置顶</a>')+'<a @click="revampMsg('+s+')">修改</a><a @click="deleteBtn('+s+')">删除</a>'}}],total:0,showNewDialog:!1,showDeleteDialog:!1,newProject:{itemName:"",salePrice:"",originalPrice:"",itemType:"",sort:1,topState:0},searchTable:{orderBy:"topState desc,sort asc,updateTime desc",startPage:1,pageSize:10,searchValue:"",itemType:""},ServiceItemType:[],nameLength:0,id:0,revamp:!1,sortNum:0,patchNum:0}},methods:{getDates:function(){var e=this;this.$ajax(this.$joggle.merchant.setting.selectPageServiceItem,this.searchTable,!0,function(t,s){s.close(),"ZS011000"==t.code?(e.datas=t.data.list,e.total=t.data.total,e.datas.forEach(function(t){e.$set(t,"sortState",!1)})):e.$message({type:"error",duration:1200,message:t.msg})})},insertProject:function(){var e=this;this.newProject.salePrice=parseFloat(this.newProject.salePrice).toFixed(2),this.newProject.originalPrice=this.newProject.salePrice,this.$ajax(this.$joggle.merchant.setting.insertServiceItem,this.newProject,!0,function(t,s){s.close(),"ZS011000"==t.code?(e.showNewDialog=!1,e.searchTable.startPage=1,e.getDates(),e.$message({type:"success",duration:1200,message:"新建成功"})):e.$message({type:"error",duration:1200,message:t.msg})})},deleteItem:function(e){var t=this;e?this.$ajax(this.$joggle.merchant.setting.deleteServiceItem,{id:this.id},!0,function(e,s){s.close(),"ZS011000"==e.code?(t.showDeleteDialog=!1,t.searchTable.startPage=1,t.getDates(),t.$message({type:"success",duration:1200,message:"删除成功"})):t.$message({type:"error",duration:1200,message:"删除失败"})}):this.$message({type:"error",duration:1200,message:"服务项正在被使用，无法删除"})},updateMessage:function(e){var t=this,s=e;this.$ajax(this.$joggle.merchant.setting.updateServiceItem,s,!0,function(e,a){a.close(),"ZS011000"==e.code?(t.$message({type:"success",duration:1200,message:t.revamp?"修改成功":1==s.topState?"置顶成功":"取消置顶成功"}),t.revamp=!1,t.showNewDialog=!1):(t.$message({type:"error",duration:1200,message:t.revamp?"修改失败":1==s.topState?"置顶成功":"取消置顶成功"}),t.revamp=!1,t.showNewDialog=!1)})},deleteMsg:function(){var e=this;this.$ajax(this.$joggle.merchant.setting.selectWhetherServiceItemEdit,{id:this.id},!0,function(t,s){s.close(),"ZS011000"==t.code?e.deleteItem(t.data):e.$message({type:"error",duration:1200,message:t.msg})})},insertJudge:function(){var e=/(\D)/g,t=/^\d+(\.\d+)?$/,i="";if(s.i(a.c)(this.newProject.itemName)?i="请输入项目名称":s.i(a.c)(this.newProject.salePrice)?i="请输入项目价格":t.test(this.newProject.salePrice)?s.i(a.c)(this.newProject.itemType)?i="请选择项目所属分类":s.i(a.c)(this.newProject.sort)?i="排序不能为空":(e.test(this.newProject.sort)||parseFloat(this.newProject.sort)<=0)&&(i="请输入正确的排序"):i="请输入正确的价格",""!=i)return this.$message({type:"error",duration:1e3,message:i}),!1;if(this.revamp){var r={};r=Object.assign({},this.newProject),r.id=this.id,r.salePrice=parseFloat(r.salePrice).toFixed(2),r.originalPrice=r.salePrice,this.$set(this.datas[this.patchNum],"itemName",r.itemName),this.$set(this.datas[this.patchNum],"salePrice",r.salePrice),this.$set(this.datas[this.patchNum],"originalPrice",r.originalPrice),this.$set(this.datas[this.patchNum],"itemType",r.itemType),this.$set(this.datas[this.patchNum],"sort",r.sort),this.$set(this.datas[this.patchNum],"topState",r.topState),this.updateMessage(r)}else this.insertProject()},handleOldInsertItemTimes:function(e){this.sortNum=this.datas[e].sort},handleOpenInsertItemTimes:function(e){var t=this;this.datas.forEach(function(e){t.$set(e,"sortState",!1)}),this.$set(this.datas[e],"sortState",!0)},handleCloseInsertItemTimes:function(e,t){if(this.$set(this.datas[e],"sortState",!1),s.i(a.c)(t.target.value)||parseInt(t.target.value)<1)return this.$message({type:"error",duration:1200,message:"您输入有误"}),void this.$set(this.datas[e],"sort",this.sortNum);if(parseInt(t.target.value)!=this.sortNum){var i=this.datas[e],r={};r.itemName=i.itemName,r.salePrice=i.salePrice,r.originalPrice=i.originalPrice,r.itemType=i.itemType,r.sort=i.sort,r.id=i.id,r.topState=i.topState,this.revamp=!0,this.updateMessage(r)}},handleChangeItemTimes:function(e,t){this.$set(this.datas[e],"sort",this.calcItemTimes(t.target.value))},calcItemTimes:function(e){return s.i(a.c)(e)||parseInt(e)<=0?this.sortNum:parseInt(e)},showDialog:function(){this.recoverForm(),this.showNewDialog=!0},deleteBtn:function(e){var t=this.datas[e];this.id=t.id,this.showDeleteDialog=!0},isTop:function(e,t){var s=this.datas[e],a={};a.itemName=s.itemName,a.salePrice=s.salePrice,a.originalPrice=s.originalPrice,a.itemType=s.itemType,a.sort=0==s.topState?1:s.sort,a.id=s.id,a.topState=0==s.topState?1:0,this.$set(this.datas[e],"topState",t),this.updateMessage(a)},revampMsg:function(e){this.patchNum=e,this.leadingForm(e),this.revamp=!0,this.showNewDialog=!0},recoverForm:function(){this.newProject.itemName="",this.newProject.salePrice="",this.newProject.itemType="",this.newProject.sort=1},leadingForm:function(e){var t=this.datas[e];this.newProject.itemName=t.itemName,this.newProject.salePrice=t.salePrice,this.newProject.originalPrice=t.originalPrice,this.newProject.itemType=t.itemType?t.itemType+"":"",this.newProject.sort=t.sort,this.newProject.topState=t.topState,this.id=t.id},changePageNum:function(e){this.searchTable.startPage=e,this.getDates()},changePageSize:function(e){this.searchTable.startPage=1,this.searchTable.pageSize=e,this.getDates()}},mounted:function(){var e=this,t={codeTypes:"ServiceItemType"};this.$ajax(this.$joggle.mzscp.selectConstantTypes,JSON.stringify(t),!1,function(t){if("ZS011000"==t.code){var s=t.data;e.ServiceItemType=s.ServiceItemType,e.getDates()}else e.$message({type:"error",duration:1200,message:t.msg})})}}},263:function(e,t,s){function a(e){s(395)}var i=s(0)(s(169),s(303),a,null,null);e.exports=i.exports},264:function(e,t,s){function a(e){s(421)}var i=s(0)(s(170),s(349),a,null,null);e.exports=i.exports},303:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"workorder-page"},[s("ma-head",{attrs:{currId:6}}),e._v(" "),s("zs-breadcrumb",[s("zs-breadcrumb-item",[e._v("服务项目")])],1),e._v(" "),s("list",{tag:"component"})],1)},staticRenderFns:[]}},349:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"services-list"},[s("div",{staticClass:"services-header"},[s("zs-button",{attrs:{type:"primary"},on:{click:e.showDialog}},[e._v("新建项目")])],1),e._v(" "),s("div",{staticClass:"list-content"},[s("zs-table",{staticClass:"employee-table",attrs:{data:e.datas,columns:e.columns,context:e.context,"no-data-colspan":6,border:""}})],1),e._v(" "),e.datas.length>0?s("div",{staticClass:"page-div"},[s("zs-pagination",{attrs:{current:e.searchTable.startPage,total:e.total,"page-size":e.searchTable.pageSize,"show-total":"","show-elevator":"","show-sizer":""},on:{"on-change":e.changePageNum,"on-page-size-change":e.changePageSize}})],1):e._e(),e._v(" "),s("zs-dialog",{staticClass:"new-dialog",attrs:{"show-close":""},model:{value:e.showNewDialog,callback:function(t){e.showNewDialog=t},expression:"showNewDialog"}},[0==e.revamp?s("p",{slot:"title"},[e._v("新建项目")]):s("p",{slot:"title"},[e._v("修改项目")]),e._v(" "),s("div",{staticClass:"dialog-body"},[s("zs-form",[s("ul",{staticClass:"dialog-input"},[s("li",[s("zs-input",{attrs:{maxlength:10,placeholder:"请输入服务项目名称"},model:{value:e.newProject.itemName,callback:function(t){e.newProject.itemName=t},expression:"newProject.itemName"}})],1),e._v(" "),s("li",{staticClass:"hint"},[e._v(e._s(e.newProject.itemName.length+"/10"))]),e._v(" "),s("li",[s("em",[e._v("*")]),e._v(" 项目名称")])]),e._v(" "),s("ul",{staticClass:"dialog-input"},[s("li",[s("zs-input",{attrs:{maxlength:25,placeholder:"请输入服务项目价格"},model:{value:e.newProject.salePrice,callback:function(t){e.newProject.salePrice=t},expression:"newProject.salePrice"}})],1),e._v(" "),s("li",[s("em",[e._v("*")]),e._v(" 项目价格")])]),e._v(" "),s("ul",{staticClass:"dialog-input"},[s("li",[s("zs-select",{staticClass:"select-form-select",attrs:{placeholder:"请选择项目所属分类"},on:{change:function(e){}},model:{value:e.newProject.itemType,callback:function(t){e.newProject.itemType=t},expression:"newProject.itemType"}},[s("zs-option",{attrs:{value:"",label:"请选择项目所属分类"}}),e._v(" "),e._l(e.ServiceItemType,function(e,t){return s("zs-option",{key:t,attrs:{value:e[0],label:e[1]}})})],2)],1),e._v(" "),s("li",[s("em",[e._v("*")]),e._v(" 所属分类")])]),e._v(" "),s("ul",{staticClass:"dialog-input"},[s("li",[s("zs-input",{attrs:{maxlength:10,value:"1"},model:{value:e.newProject.sort,callback:function(t){e.newProject.sort=t},expression:"newProject.sort"}})],1),e._v(" "),s("li",[s("em",[e._v("*")]),e._v(" 排序")])])])],1),e._v(" "),s("template",{slot:"footer"},[s("zs-button",{attrs:{type:"cancel"},on:{click:function(t){e.showNewDialog=!1}}},[e._v("取消\n            ")]),e._v(" "),s("zs-button",{attrs:{type:"primary"},on:{click:e.insertJudge}},[e._v("确定\n            ")])],1)],2),e._v(" "),s("zs-dialog",{staticClass:"del-dialog",attrs:{"show-close":""},model:{value:e.showDeleteDialog,callback:function(t){e.showDeleteDialog=t},expression:"showDeleteDialog"}},[s("p",{slot:"title"},[e._v("删除")]),e._v(" "),s("div",{staticClass:"dialog-body"},[s("div",{staticClass:"del-img"}),e._v(" "),s("div",{staticClass:"del-p"},[e._v("确认删除该项目?")])]),e._v(" "),s("template",{slot:"footer"},[s("zs-button",{attrs:{type:"cancel"},on:{click:function(t){e.showDeleteDialog=!1}}},[e._v("取消\n            ")]),e._v(" "),s("zs-button",{attrs:{type:"primary"},on:{click:e.deleteMsg}},[e._v("确定\n            ")])],1)],2)],1)},staticRenderFns:[]}},395:function(e,t){},421:function(e,t){},466:function(e,t,s){e.exports=s(56)},56:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s(2),i=s(263),r=s.n(i),o=s(5),n=(s.n(o),s(3),s(4));a.a.use(n.a),new a.a({el:"#app",render:function(e){return e(r.a)}})}},[466]);