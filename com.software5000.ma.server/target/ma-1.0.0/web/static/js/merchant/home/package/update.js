webpackJsonp([13],{159:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a(1),i=a(254),c=a.n(i),n=a(6),r=a.n(n);t.default={components:{maining:c.a,maHead:r.a},data:function(){return{id:""}},computed:{},methods:{},mounted:function(){this.id=a.i(s.f)("id")}}},160:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a(1),i=["employeePage","memberPage","itemPage"],c=["selectEmployeeDatas","memberSearch","selectServiceItem"];t.default={name:"maining",data:function(){return{id:"",packageBaseData:{packageName:"",salePrice:"",validTerm:"",originalPrice:"",instructions:"",packageAndItems:[]},context:this,packageColumns:[{title:"套餐项目",key:"serviceItemName",width:254},{title:"数量",width:68,className:"item-times",render:function(e,t,a,s){return e._readonly?'<p @click="handleOpenInsertItemTimes('+a+')">'+s.calcItemTimes(e.useTimes)+"</p>":'\n                                <input\n                                    class="item-times"\n                                    type="number"\n                                    autofocus\n                                    value="'+s.calcItemTimes(e.useTimes)+'"\n                                    @blur="handleCloseInsertItemTimes('+a+')"\n                                    @change="handleChangeItemTimes('+a+',$event)">'}},{title:"单价",key:"salePrice",width:210},{title:"操作",key:"serviceItemName",width:118,className:"control",render:function(e,t,a){return'<i @click="delItem('+a+')" class="zs-icon-delete2"></i>'}}],userResultVisible:!1,itemSearchKey:"",itemDatas:[],itemColumns:[{title:"服务项目",key:"itemName"},{title:"售价",key:"salePrice"}],itemTypes:[],itemType:"",itemSelectDatas:[],itemSelectColumns:[{title:"已选项目",key:"",width:200},{title:"售价",key:"",width:68},{title:"数量",key:"",width:68},{title:"套餐抵扣数",key:"",width:108},{title:"总金额",key:"",width:104},{title:"派工人员",key:"",width:102},{title:"销售人员",key:"",width:102},{title:"操作",key:"",width:90}],carNumSelectVisible:!1,currCarArea:"闽",currCarLetter:"D",defaultCarNum:"闽D",carNumArea:["（京）北京","（津）天津","（沪）上海","（渝）重庆","（冀）河北","（豫）河南","（云）云南","（辽）辽宁","（黑）黑龙江","（湘）湖南","（皖）安徽","（鲁）山东","（新）新疆","（苏）江苏","（浙）浙江","（赣）江西","（鄂）湖北","（桂）广西","（甘）甘肃","（晋）山西","（蒙）内蒙古","（陕）陕西","（吉）吉林","（闽）福建","（贵）贵州","（粤）广东","（青）青海","（藏）西藏","（川）四川","（宁）宁夏","（琼）海南"],carNumLetter:["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],tempItemVisible:!1,employeeSelectVisible:!1,employeeDatas:[{name:"大波波",type:"管理员",selected:!1},{name:"小波波",type:"操作员",selected:!0}],employeeColumns:[{title:"",width:114,render:function(e){return'<span class="table-radio '+(e.selected?"curr":"")+'"></span>'}},{title:"员工姓名",key:"name",width:226},{title:"工种",key:"type",width:184}],itemPage:{startPage:1,pageSize:10,total:0}}},computed:{packageWrapStyle:function(){return"max-height:138px;"},packageCount:function(){var e=this,t=0;for(var a in this.itemSelectDatas)t+=e.itemSelectDatas[a].useTimes*e.itemSelectDatas[a].salePrice;return Number(Number(t).toFixed(2))}},watch:{},methods:{getPackageData:function(e,t){var i=this;this.$ajax(this.$joggle.merchant.businessPackage.selectBusinessPackageById,{businessPackageId:this.id},t,function(c,n){if(t&&n.close(),"ZS011000"===c.code){i.packageBaseData=c.data;for(var r=c.data.packageAndItems,l=[],m=0;m<r.length;m++)l[m]={id:"",serviceItemId:r[m].serviceItemId,serviceItemName:r[m].serviceItem.itemName,useTimes:r[m].useTimes,usePackageTimes:0,salePrice:r[m].serviceItem.salePrice,workerId:"",salerId:"",itemType:r[m].serviceItem.itemType,_readonly:!0};i.itemSelectDatas=l}else i.$message({type:"error",message:c.msg}),setTimeout(function(){a.i(s.a)("/web/merchant/home/package/list.html")},1200);e&&e()})},selectServiceItem:function(e,t){var a=this;this.$ajax(this.$joggle.merchant.workorder.selectServiceItem,{startPage:this.itemPage.startPage,pageSize:this.itemPage.pageSize,searchValue:this.itemSearchKey,itemType:this.itemType},t,function(t){"ZS011000"===t.code?(a.itemPage.total=t.data.total,a.itemDatas=t.data.list):a.$message({type:"error",message:t.msg}),e&&e()})},delItem:function(e){var t=a.i(s.m)(this.itemSelectDatas);this.$delete(t,e),this.itemSelectDatas=t},handleCloseSearchResult:function(){this.userResultVisible=!1},handleSetCarLetter:function(e){a.i(s.c)(this.currCarArea)||(this.currCarLetter=e,this.carNumSelectVisible=!1)},handleSetDefault:function(e){a.i(s.c)(this.currCarArea)||(this.currCarLetter=e,this.defaultCarNum=""+this.currCarArea+e,this.carNumSelectVisible=!1)},handleSetDefaultText:function(e){return this.currCarArea===this.defaultCarNum[0]&&e===this.defaultCarNum[1]?"默认":"设为默认"},handleItemSearch:function(){this.itemPage.startPage=1,this.selectServiceItem(function(){},!1)},handleEmptyItemSearchKey:function(){this.itemSearchKey="",this.handleItemSearch()},handleSelectItemType:function(e){this.itemType=e,this.itemPage.startPage=1;var t=this.$loading();this.selectServiceItem(function(){t.close()},t)},handleItemSelect:function(e){for(var t=this,i=!0,c=0;c<this.itemSelectDatas.length;c++)if(e.id===t.itemSelectDatas[c].serviceItemId){i=!1,t.itemSelectDatas[c].useTimes++;break}if(i){var n={id:"",serviceItemId:e.id,serviceItemName:e.itemName,useTimes:1,usePackageTimes:0,salePrice:e.salePrice,workerId:"",salerId:"",itemType:e.itemType,_readonly:!0},r=a.i(s.m)(this.itemSelectDatas);r.unshift(n),this.itemSelectDatas=r}},handlePageChange:function(e,t){this[i[e]].startPage=t;var a=this.$loading();this[c[e]](function(){a.close()},a)},selectItemType:function(e,t){var a=this;this.$ajax(this.$joggle.mzscp.selectConstantTypes,{codeTypes:"ServiceItemType"},t,function(t){if("ZS011000"===t.code){var s=t.data.ServiceItemType;s.unshift({0:"",1:"全部"}),a.itemTypes=s}else a.$message({type:"error",message:t.msg,duration:1200});e&&e()})},handleOpenInsertItemTimes:function(e){this.itemSelectDatas[e]._readonly&&this.$set(this.itemSelectDatas[e],"_readonly",!1)},handleCloseInsertItemTimes:function(e){this.$set(this.itemSelectDatas[e],"_readonly",!0)},handleChangeItemTimes:function(e,t){this.$set(this.itemSelectDatas[e],"useTimes",this.calcItemTimes(t.target.value))},calcItemTimes:function(e){return a.i(s.c)(e)||parseInt(e)<=0?1:parseInt(e)},certPackage:function(){var e=this,t={packageName:"请输入套餐名",salePrice:"请输入正确的套餐价格",validTerm:"请选择有效期",originalPrice:"请选择服务项目"};for(var i in t){var c=e.packageBaseData[i]+"",n="salePrice"==i&&!c.isInReg(/^\d+(\.\d+)?$/),r="originalPrice"==i&&0==c;if(a.i(s.c)(c)||n||r)return e.$message({type:"error",message:t[i],duration:1200}),!1}return!0},ToCDB:function(e){for(var t="",a=0;a<e.length;a++)12288!=e.charCodeAt(a)?e.charCodeAt(a)>65280&&e.charCodeAt(a)<65375?t+=String.fromCharCode(e.charCodeAt(a)-65248):t+=String.fromCharCode(e.charCodeAt(a)):t+=String.fromCharCode(e.charCodeAt(a)-12256);return t},savePackage:function(){var e=this;this.packageBaseData.packageAndItems=this.itemSelectDatas,this.packageBaseData.originalPrice=this.packageCount,this.certPackage()&&(this.packageBaseData.salePrice=(this.packageBaseData.salePrice+"").indexOf(".")>-1?parseFloat(this.packageBaseData.salePrice).toFixed(2):this.packageBaseData.salePrice,this.id?this.$ajax(this.$joggle.merchant.businessPackage.updateBusinessPackage,this.packageBaseData,!0,function(t,i){i.close(),"ZS011000"===t.code?(e.$message({type:"success",message:t.msg,duration:1200}),setTimeout(function(){a.i(s.a)("/web/merchant/home/package/list.html")},1200)):e.$message({type:"error",message:t.msg})}):this.$ajax(this.$joggle.merchant.businessPackage.insertBusinessPackage,this.packageBaseData,!0,function(t,i){i.close(),"ZS011000"===t.code?(e.$message({type:"success",message:t.msg,duration:1200}),setTimeout(function(){a.i(s.a)("/web/merchant/home/package/list.html")},1200)):e.$message({type:"error",message:t.msg})}))},turnPage:function(e){a.i(s.a)(e)}},created:function(){var e=this;this.id=a.i(s.f)("id");var t=this.$loading(),i=new Promise(function(t){e.id?e.getPackageData(function(){t()},!1):t()}),c=new Promise(function(t){e.selectServiceItem(function(){t()},!1)}),n=new Promise(function(t){e.selectItemType(function(){t()},!1)});Promise.all([i,c,n]).then(function(){t.close()})}}},253:function(e,t,a){function s(e){a(390)}var i=a(0)(a(159),a(295),s,null,null);e.exports=i.exports},254:function(e,t,a){function s(e){a(442)}var i=a(0)(a(160),a(380),s,null,null);e.exports=i.exports},295:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"workorder-page"},[a("ma-head"),e._v(" "),a("zs-breadcrumb",[a("zs-breadcrumb-item",{attrs:{to:"/web/merchant/home/member/package.html"}},[e._v("会员套餐")]),e._v(" "),a("zs-breadcrumb-item",[e._v(e._s(e.id?"修改套餐":"新建套餐"))])],1),e._v(" "),a("maining",{tag:"component"})],1)},staticRenderFns:[]}},380:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page-main"},[a("div",{staticClass:"page-left"},[a("div",{staticClass:"page-left-top"},[a("div",{staticClass:"list"},[a("div",{staticClass:"list-item detail-list-item"},[e._m(0),e._v(" "),a("div",{staticClass:"list-item-con"},[a("zs-input",{staticClass:"list-item-con-input",attrs:{maxlength:10,placeholder:"请输入套餐名称"},model:{value:e.packageBaseData.packageName,callback:function(t){e.packageBaseData.packageName=t},expression:"packageBaseData.packageName"}}),e._v(" "),a("span",{staticClass:"list-item-con-input-length"},[e._v(e._s(e.packageBaseData.packageName.length+"/10"))])],1)]),e._v(" "),a("div",{staticClass:"list-item detail-list-item"},[e._m(1),e._v(" "),a("div",{staticClass:"list-item-con"},[a("zs-input",{staticClass:"list-item-con-input",attrs:{placeholder:"请输入套餐价格"},model:{value:e.packageBaseData.salePrice,callback:function(t){e.packageBaseData.salePrice=t},expression:"packageBaseData.salePrice"}})],1)]),e._v(" "),a("div",{staticClass:"list-item detail-list-item"},[e._m(2),e._v(" "),a("div",{staticClass:"list-item-con"},[a("zs-select",{model:{value:e.packageBaseData.validTerm,callback:function(t){e.packageBaseData.validTerm=t},expression:"packageBaseData.validTerm"}},[a("zs-option",{attrs:{value:1,label:"1年"}}),e._v(" "),a("zs-option",{attrs:{value:2,label:"2年"}}),e._v(" "),a("zs-option",{attrs:{value:3,label:"3年"}}),e._v(" "),a("zs-option",{attrs:{value:0,label:"永久"}})],1)],1)])]),e._v(" "),a("div",{staticClass:"page-left-bottom"},[a("p",{staticClass:"package-words"},[e._v("套餐项目总价："),a("span",{staticClass:"red"},[e._v(e._s(e.packageCount))])]),e._v(" "),a("zs-table",{staticClass:"package-table",attrs:{data:e.itemSelectDatas,columns:e.packageColumns,context:e.context,"no-data-colspan":4,noDataText:"暂无数据",border:""}}),e._v(" "),a("p",{staticClass:"package-words"},[e._v("使用说明：")]),e._v(" "),a("zs-input",{staticClass:"package-textarea",attrs:{type:"textarea",resize:"none",maxlength:200},model:{value:e.packageBaseData.instructions,callback:function(t){e.packageBaseData.instructions=t},expression:"packageBaseData.instructions"}}),e._v(" "),a("div",{staticClass:"package-control"},[a("zs-button",{attrs:{type:"cancel"},on:{click:function(t){e.turnPage("/web/merchant/home/package/list.html")}}},[e._v("取消\n                    ")]),e._v(" "),a("zs-button",{attrs:{type:"primary"},on:{click:e.savePackage}},[e._v("保存")])],1)],1)])]),e._v(" "),a("div",{staticClass:"page-right"},[a("p",{staticClass:"block-5-title"},[e._v("可选项目")]),e._v(" "),a("div",{staticClass:"search-wrapper"},[a("zs-input",{attrs:{icon:"circle-cross",placeholder:"请输入服务项目关键词进行搜索"},on:{"on-icon-click":e.handleEmptyItemSearchKey,change:e.handleItemSearch},model:{value:e.itemSearchKey,callback:function(t){e.itemSearchKey=t},expression:"itemSearchKey"}})],1),e._v(" "),a("div",{staticClass:"block-5-item"},[a("dl",{staticClass:"block-5-menu"},[a("dt",[e._v("项目分类")]),e._v(" "),e._l(e.itemTypes,function(t){return a("dd",{key:t[0],class:[{curr:t[0]===e.itemType}],on:{click:function(a){e.handleSelectItemType(t[0])}}},[e._v(e._s(t[1])+"\n                ")])})],2),e._v(" "),a("div",{staticClass:"block-5-main"},[a("zs-table",{attrs:{data:e.itemDatas,columns:e.itemColumns,context:e.context,"no-data-colspan":2,border:""},on:{"on-row-click":e.handleItemSelect}}),e._v(" "),a("zs-pagination",{attrs:{current:e.itemPage.startPage,total:e.itemPage.total,"page-size":e.itemPage.pageSize,simple:""},on:{"on-change":function(t){e.handlePageChange(2,t)}}})],1)])])])},staticRenderFns:[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"list-item-text"},[a("i",{staticClass:"request"}),e._v("套餐名称")])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"list-item-text"},[a("i",{staticClass:"request"}),e._v("套餐价格")])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"list-item-text"},[a("i",{staticClass:"request"}),e._v("有效期")])}]}},390:function(e,t){},442:function(e,t){},462:function(e,t,a){e.exports=a(52)},52:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a(2),i=a(253),c=a.n(i),n=a(5),r=(a.n(n),a(3),a(4));s.a.use(r.a),new s.a({el:"#app",render:function(e){return e(c.a)}})}},[462]);