webpackJsonp([45],{150:function(e,s,a){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var t=a(6),i=a.n(t),n=a(9),r=a.n(n),c=a(2),o=a(7),l=a(8);a(10);s.default={components:{carNumber:r.a,maHead:i.a},data:function(){return{isLoading:!0,openId:"",id:"",openRecordId:"",packCulsterData:{businessPackage:{}},businessId:"",packId:"",mobile:"",carNumber:"",businessName:"",imgSrc:"",packageAndItems:[]}},computed:{packageItemText:function(){var e="";if(!a.i(c.c)(this.packageAndItems)){for(var s=this.packageAndItems.packageAndItems,t=0;t<s.length;t++)e+=s[t].serviceItem.itemName+" *"+s[t].useTimes+"、";e=e.substring(0,e.length-1)}return e}},methods:{getData:function(e,s){var a=this;this.$ajax(this.$joggle.customer.packcluster.selectPackClusterInfo,{id:this.id},s,function(s){if("ZS011000"===s.code){a.packCulsterData=s.data,a.images=s.data.packClusterImgs;var t=new Promise(function(e){a.handleBusinessName(function(){e()},a.packCulsterData.packId)}),i=new Promise(function(e){a.handleBusinessId(function(){e()},a.packCulsterData.businessId)});Promise.all([t,i]).then(function(){e&&e()})}else a.$message({type:"error",message:s.msg})})},handleBusinessName:function(e,s){var a=this;this.$ajax(this.$joggle.customer.packcluster.selectBusinessPackageForOpenEmkt,{packIds:s},!1,function(t){"ZS011000"===t.code?a.packageAndItems=t.data[s]:a.$message({type:"error",message:t.msg}),e&&e()})},handleGetCarNumber:function(e){this.carNumber=e},handleConfirm:function(){var e=this,s="";a.i(c.i)(this.mobile)?a.i(c.h)(this.carNumber)||(s="车牌号码有误!"):s="手机号有误!",s?this.$message({type:"error",message:s,duration:"1000"}):this.certJoinGroup(function(){e.handGroupOrder()})},certJoinGroup:function(e){var s=this;this.$ajax(this.$joggle.customer.packcluster.selectHaveBuyPackCluster,{packClusterId:this.id,wxOpenId:this.openId,carNumber:this.carNumber,mobile:this.mobile},!0,function(a,t){if("ZS011000"===a.code)if(a.data){t.close();var i=a.data;i="该车牌已被尾号为"+i.substring(i.length-4)+"的手机号绑定，确认继续支付？",s.$confirm({title:"警告",message:i,customClass:"join-message"}).then(function(s){e&&e()}).catch(function(){})}else e&&e();else t.close(),s.$message({type:"error",message:a.msg,duration:"1000"})})},handGroupOrder:function(){var e=this;this.$ajax(this.$joggle.customer.packcluster.insertPackClusterBuyRecordByPay,{wxOpenId:this.openId,mobile:this.mobile,carNumber:this.carNumber,payMoney:100*this.packCulsterData.salePrice,packClusterId:this.id,openRecordId:this.openRecordId},!0,function(s,t){"ZS011000"===s.code?a.i(c.d)(s.data):(t.close(),e.$message({type:"error",message:s.msg,duration:"1000"}))})},handleBusinessId:function(e,s){var a=this;this.$ajax(this.$joggle.customer.packcluster.selectEnableBusinessNameList,{businessIds:s+""},!0,function(t,i){"ZS011000"===t.code?a.businessName=t.data[s].businessName:(i.close(),a.$message({type:"error",message:t.msg,duration:"1000"})),e&&e()})}},created:function(){this.openId=a.i(c.a)("i")?l.a.decode(a.i(c.a)("i")):"",this.id=a.i(c.a)("id")?parseInt(a.i(c.a)("id")):"",this.openRecordId=a.i(c.a)("openRecordId")?parseInt(a.i(c.a)("openRecordId")):"",this.openId&&this.id||(this.$message({type:"error",message:"请从拼团活动页面进入",duration:"1000"}),setTimeout(function(){a.i(o.a)("/wap/open/customer/detail_user.html","emkt")},1e3));var e=this.$loading();this.getData(function(){e.close()},e)}}},225:function(e,s,a){a(379);var t=a(0)(a(150),a(306),null,null);e.exports=t.exports},306:function(e,s){e.exports={render:function(){var e=this,s=e.$createElement,a=e._self._c||s;return a("div",{staticClass:"pay-page"},[a("ma-head",{attrs:{home:!1}},[e._v("拼团\n    ")]),e._v(" "),a("div",{staticClass:"store-name"},[a("zs-icon",{attrs:{size:15,icon:"merchant",text:e.businessName}})],1),e._v(" "),a("div",{staticClass:"package"},[null!=e.packageAndItems?a("div",{staticClass:"package-left",style:"background-image: url("+(e.packCulsterData.shareImgPath?e.packCulsterData.shareImgPathUrl:e.packCulsterData.packClusterImgs[0].imgPathUrl)+")"}):e._e(),e._v(" "),a("div",{staticClass:"package-right"},[a("div",{staticClass:"package-title"},[a("span",{staticClass:"title"},[e._v(e._s(e.packCulsterData.clusterName))]),e._v(" "),a("span",{staticClass:"r"},[e._v(e._s(e.packCulsterData.clusterNum)+"人团")])]),e._v(" "),a("div",{staticClass:"package-date"},[e._v("\n                "+e._s(e.packageAndItems.packageName)+"(有效期"+e._s(0!=e.packageAndItems.validTerm?e.packageAndItems.validTerm+"年":"永久")+")\n            ")]),e._v(" "),a("div",{staticClass:"package-item"},[e._v(e._s(e.packageItemText))])])]),e._v(" "),a("div",{staticClass:"price"},[a("span",{staticClass:"del"},[e._v("原价：￥"+e._s(e.packageAndItems.salePrice))]),a("span",{staticClass:"gray"},[e._v("拼团价")]),a("span",{staticClass:"black"},[e._v("￥"+e._s(e.packCulsterData.salePrice))])]),e._v(" "),a("ul",{staticClass:"input-wrapper"},[a("li",{staticClass:"input-wrapper-li"},[a("span",{staticClass:"input-label"},[e._v("手机号")]),e._v(" "),a("zs-input",{attrs:{maxlength:11,placeholder:"请输入手机号",icon:"circle-cross"},model:{value:e.mobile,callback:function(s){e.mobile=s},expression:"mobile"}})],1),e._v(" "),a("li",{staticClass:"input-wrapper-li"},[a("car-number",{on:{"get-car-number":e.handleGetCarNumber}})],1)]),e._v(" "),a("div",{staticClass:"footer"},[a("div",{staticClass:"footer-main"},[a("div",{staticClass:"footer-left"},[e._v("\n                实收款:"),a("span",{staticClass:"red"},[e._v("￥"+e._s(e.packCulsterData.salePrice))])]),e._v(" "),a("div",{staticClass:"confirm-btn",on:{click:e.handleConfirm}},[e._v("去支付")])])])],1)},staticRenderFns:[]}},379:function(e,s){},456:function(e,s,a){e.exports=a(53)},53:function(e,s,a){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var t=a(1),i=a(225),n=a.n(i),r=a(5),c=(a.n(r),a(3),a(4));t.a.use(c.a),new t.a({el:"#app",render:function(e){return e(n.a)}})}},[456]);