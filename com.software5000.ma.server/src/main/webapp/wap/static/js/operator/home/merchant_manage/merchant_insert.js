webpackJsonp([3],{189:function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var s=e(6),a=e.n(s),n=e(27),r=e.n(n),c=e(13),l=e(2);i.default={components:{maHead:a.a,cityPicker:r.a},data:function(){return{tempAddr:[],pcd:"",addressShow:"请选择",merchantState:!0,imgShow:"",cityPickerVisible:!1,map:null,geo:null,finalData:{businessName:"",businessTel:"",businessAreaCode:"",businessAddress:"",businessDetail:"",imgPath:"",businessCoordinate:"",businessLineState:1}}},watch:{tempAddr:function(t){var i=this;this.pcd=[];var e=[];t.forEach(function(t){i.pcd.push(t.fullName),e.push(t.id)}),this.finalData.businessAreaCode=e.join(",")},merchantState:function(t){this.finalData.businessLineState=t?1:2}},methods:{hangleUpLoad:function(t){var i=this,s=this.$modal();e.i(c.a)(t.target,600,function(t){i.finalData.imgPath=t.slice(23),i.imgShow=t,s.close()})},handleGetAddress:function(t){this.tempAddr=[],this.tempAddr=t,this.setAddressShow(t)},setAddressShow:function(t){if(0==t.length)this.addressShow="请选择";else{var i=[];t.forEach(function(t){i.push(t.areaName)}),this.addressShow=i.join(" | ")}},handleGetPoint:function(t,i,e){var s=this;this.geo.getPoint(i,function(t){if(!t)return void s.$modal({type:"error",message:"你输入的地址获取不到地理位置",duration:1200});e&&e(t)},t)},isValidateFull:function(){var t=this,i={businessName:"请输入商家名",businessTel:"请输入电话号码",businessAreaCode:"请选择地址",businessAddress:"请输入详细地址",businessDetail:"请输入描述",imgPath:"请上传图片"};for(var e in i)if(!t.finalData[e]||""==t.finalData[e])return t.$modal({type:"error",message:i[e],duration:1200}),!1;return!0},isValidateRight:function(){var t=this,i={businessTel:"电话号码有误"},s=!e.i(l.i)(this.finalData.businessTel)&&!e.i(l.m)(this.finalData.businessTel);for(var a in i)if("businessTel"==a&&s)return t.$modal({type:"error",message:i[a],duration:1200}),!1;return!0},handleSubmit:function(){var t=this;if(this.isValidateFull()&&this.isValidateRight()){var i=this.pcd.join("")+this.finalData.businessAddress,s=this.pcd[0];this.handleGetPoint(s,i,function(i){t.finalData.businessCoordinate=i.lng+","+i.lat,t.$ajax(t.$joggle.business.insertBusiness,t.finalData,!0,function(i,s){s.close(),"ZS011000"===i.code?(t.$message({type:"success",message:"创建成功",duration:1200}),setTimeout(function(){e.i(l.d)("/wap/operator/home/merchant_manage/merchant_list.html")},1200)):t.$message({type:"error",message:i.msg,duration:1200})})})}}},mounted:function(){this.map=new BMap.Map("map"),this.geo=new BMap.Geocoder}}},23:function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default={props:{value:!1},data:function(){return{addressVisible:!0,liHeight:40,start:{Y:0,time:""},move:{Y:0,speed:[]},end:{Y:0,status:!0},maxHeight:[0,0,0],distance:[0,0,0],dis:[0,0,0],provinces:[],citys:[],districts:[],finalAddr:[{id:35e4,areaName:"福建",fullName:"福建省"},{id:350200,areaName:"厦门",fullName:"厦门市"},{id:350203,areaName:"思明",fullName:"思明区"}]}},computed:{provinceStyle:function(){var t={};return t.transform="translateY("+this.dis[0]+"px)",t.transition="transform "+this.move.speed[0]+"s ease-out",t},cityStyle:function(){var t={};return t.transform="translateY("+this.dis[1]+"px)",t.transition="transform "+this.move.speed[1]+"s ease-out",t},districtStyle:function(){var t={};return t.transform="translateY("+this.dis[2]+"px)",t.transition="transform "+this.move.speed[2]+"s ease-out",t}},methods:{handleGetProvinces:function(t){var i=this;this.$ajax(this.$joggle.mzscp.selectProvince,{},!1,function(e){"ZS011000"===e.code&&(i.maxHeight[0]=(e.data.length+4)*i.liHeight,i.provinces=e.data,t&&t())})},handleGetCitys:function(t,i){var e=this;this.$ajax(this.$joggle.mzscp.selectAreaCode,{areaId:t},!1,function(t){"ZS011000"===t.code&&(e.maxHeight[1]=(t.data.length+4)*e.liHeight,e.citys=t.data,i&&i(e.citys))})},handleGetDistricts:function(t,i){var e=this;this.$ajax(this.$joggle.mzscp.selectAreaCode,{areaId:t},!1,function(t){"ZS011000"===t.code&&(e.maxHeight[2]=(t.data.length+4)*e.liHeight,e.districts=t.data,i&&i(e.districts))})},getProvinceIndex:function(t){for(var i=this,e=0;e<this.provinces.length;e++)if(i.provinces[e].id==t)return e},getCityIndex:function(t){for(var i=this,e=0;e<this.citys.length;e++)if(i.citys[e].id==t)return e},getDisIndex:function(t){for(var i=this,e=0;e<this.districts.length;e++)if(i.districts[e].id==t)return e},initPosition:function(t,i,e){t=t<0?0:t,t=t>i?i:t;var s=t%this.liHeight;return s<this.liHeight/2?this.distance[e]=t-s:this.distance[e]=t+(this.liHeight-s),this},initSpeed:function(t,i,e,s){var a=0,n=0,r=0;for(var c in t)n+=t[c]-0;for(var l in t)a+=(t[l]-n/t.length)*(t[l]-n/t.length);(a/t.length).toFixed(2)>.1?(r=e>15*this.liHeight?2*i:0,this.initPosition(this.distance[s]+r,e-5*this.liHeight,s),this.move.speed[0]=.2):(this.initPosition(this.distance[s],e,s),this.move.speed[0]=this.move.speed[0]>.2?.2:this.move.speed[0])},touch:function(t,i){var e=this;switch(t=t||window.event,t.preventDefault(),t.type){case"touchstart":this.end.status&&(this.end.status=!this.end.status,t.preventDefault(),this.move.speed=[],this.$set(this.start,"Y",t.touches[0].clientY),this.start.time=Date.now());break;case"touchmove":t.preventDefault(),this.$set(this.move,"Y",t.touches[0].clientY);var s=this.start.Y-this.move.Y;if(0==this.distance[i]&&s<0)this.$set(this.dis,i,1.5*this.liHeight),this.move.speed[0]=.2;else{var a=-(s+1*this.distance[i]);this.$set(this.dis,i,a)}if(Math.abs(s).toFixed(0)%5==0){var n=Date.now();this.move.speed.push((Math.abs(s)/(n-this.start.time)).toFixed(2))}break;case"touchend":this.end.Y=Math.abs(t.changedTouches[0].clientY);var r=this.distance[i]+(this.start.Y-this.end.Y);this.distance[i]=r<0?0:r<this.maxHeight[i]-5*this.liHeight?r:this.maxHeight[i]-5*this.liHeight,this.initSpeed(this.move.speed,this.start.Y-this.end.Y,this.maxHeight[i],i),this.$set(this.dis,i,-1*this.distance[i]);var c=this.distance[i]/this.liHeight;if(0==i){var l=this.provinces[c].id;this.distance[1]=this.dis[1]=0,this.distance[2]=this.dis[2]=0,this.finalAddr[0]=this.provinces[c],this.handleGetCitys(l,function(t){if(0==t.length)return e.districts=[],void(e.finalAddr[1]="");e.finalAddr[1]=t[0],e.handleGetDistricts(t[0].id,function(t){0==t.length?e.finalAddr[2]="":e.finalAddr[2]=t[0]})})}else if(1==i){this.distance[2]=this.dis[2]=0;var o=this.citys[c].id;this.finalAddr[1]=this.citys[c],this.handleGetDistricts(o,function(t){0==t.length?e.finalAddr[2]="":e.finalAddr[2]=t[0]})}else 2==i&&(this.finalAddr[2]=this.districts[c]);setTimeout(function(){e.end.status=!0},1e3*this.move.speed[0])}},getPosition:function(t,i){var e=0;0==t?e=this.getProvinceIndex(i):1==t?e=this.getCityIndex(i):2==t&&(e=this.getDisIndex(i)),this.$set(this.distance,t,e*this.liHeight),this.$set(this.dis,t,-1*this.distance[t])},initReady:function(){var t=this;this.$refs.provincePicker.addEventListener("touchstart",function(){t.touch(event,0)},!1),this.$refs.provincePicker.addEventListener("touchmove",function(){t.touch(event,0)},!1),this.$refs.provincePicker.addEventListener("touchend",function(){t.touch(event,0)},!1),this.$refs.cityPicker.addEventListener("touchstart",function(){t.touch(event,1)},!1),this.$refs.cityPicker.addEventListener("touchmove",function(){t.touch(event,1)},!1),this.$refs.cityPicker.addEventListener("touchend",function(){t.touch(event,1)},!1),this.$refs.districtPicker.addEventListener("touchstart",function(){t.touch(event,2)},!1),this.$refs.districtPicker.addEventListener("touchmove",function(){t.touch(event,2)},!1),this.$refs.districtPicker.addEventListener("touchend",function(){t.touch(event,2)},!1)},handleSubmit:function(){this.$emit("get-address",this.finalAddr),this.$emit("input",!1)},handleClose:function(){this.$emit("input",!1)}},mounted:function(){var t=this;this.handleGetProvinces(function(){t.getPosition(0,35e4),t.handleGetCitys(35e4,function(){t.getPosition(1,350200),t.handleGetDistricts(350200,function(){t.getPosition(2,350203)})})}),this.initReady()}}},264:function(t,i,e){e(407);var s=e(0)(e(189),e(340),null,null);t.exports=s.exports},27:function(t,i,e){e(36);var s=e(0)(e(23),e(33),"data-v-9c4d3c7e",null);t.exports=s.exports},33:function(t,i){t.exports={render:function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",[e("div",{directives:[{name:"show",rawName:"v-show",value:t.value,expression:"value"}],staticClass:"city-picker-marsk",on:{click:t.handleClose}}),t._v(" "),e("transition",{attrs:{name:"city-picker-slide"}},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.value,expression:"value"}],staticClass:"city-picker-container"},[e("ul",{staticClass:"city-picker-btn-box"},[e("li",{staticClass:"city-picker-btn",on:{click:t.handleClose}},[t._v("返回")]),t._v(" "),e("li",{staticClass:"city-picker-btn",on:{click:t.handleSubmit}},[t._v("提交")])]),t._v(" "),e("div",{staticClass:"city-picker-content"},[e("div",{staticClass:"city-picker"},[e("ul",{ref:"provincePicker",staticClass:"city-picker-province",style:t.provinceStyle},[e("li"),t._v(" "),e("li"),t._v(" "),t._l(t.provinces,function(i){return e("li",{key:i.id},[t._v(t._s(i.areaName))])}),t._v(" "),e("li"),t._v(" "),e("li")],2)]),t._v(" "),e("div",{staticClass:"city-picker"},[e("ul",{ref:"cityPicker",staticClass:"city-picker-city",style:t.cityStyle},[e("li"),t._v(" "),e("li"),t._v(" "),t._l(t.citys,function(i){return e("li",{key:i.id},[t._v(t._s(i.areaName))])}),t._v(" "),e("li"),t._v(" "),e("li")],2)]),t._v(" "),e("div",{staticClass:"city-picker"},[e("ul",{ref:"districtPicker",staticClass:"city-picker-district",style:t.districtStyle},[e("li"),t._v(" "),e("li"),t._v(" "),t._l(t.districts,function(i){return e("li",{key:i.id},[t._v(t._s(i.areaName))])}),t._v(" "),e("li"),t._v(" "),e("li")],2)]),t._v(" "),e("div",{staticClass:"city-picker-up-shadow"}),t._v(" "),e("div",{staticClass:"city-picker-down-shadow"}),t._v(" "),e("div",{staticClass:"city-picker-line"})])])])],1)},staticRenderFns:[]}},340:function(t,i){t.exports={render:function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"merchant-insert-page"},[e("ma-head",{attrs:{home:!1}},[t._v("添加商家")]),t._v(" "),e("ul",{staticClass:"insert-detail"},[e("li",{staticClass:"show-inline"},[e("span",{staticClass:"insert-detail-title"},[t._v("商家名称")]),t._v(" "),e("zs-input",{attrs:{maxlength:15,placeholder:"请输入商家名称",icon:"circle-cross"},model:{value:t.finalData.businessName,callback:function(i){t.finalData.businessName=i},expression:"finalData.businessName"}})],1),t._v(" "),e("li",{staticClass:"show-inline"},[e("span",{staticClass:"insert-detail-title"},[t._v("联系电话")]),t._v(" "),e("zs-input",{attrs:{placeholder:"请输入电话号码",icon:"circle-cross"},model:{value:t.finalData.businessTel,callback:function(i){t.finalData.businessTel=i},expression:"finalData.businessTel"}})],1),t._v(" "),e("li",{staticClass:"show-inline address",on:{click:function(i){t.cityPickerVisible=!0}}},[e("span",{staticClass:"insert-detail-title"},[t._v("商家地址")]),t._v(" "),e("em",{class:[{"color-black":t.tempAddr.length>0}]},[t._v(t._s(t.addressShow))]),t._v(" "),e("zs-icon",{attrs:{icon:"arrow-right",size:"10"}})],1),t._v(" "),e("li",{staticClass:"show-inline address-detail"},[e("zs-input",{attrs:{type:"textarea",resize:"none",placeholder:"详细地址"},model:{value:t.finalData.businessAddress,callback:function(i){t.finalData.businessAddress=i},expression:"finalData.businessAddress"}})],1),t._v(" "),e("li",{staticClass:"show-inline merchant-state"},[e("span",{staticClass:"insert-detail-title"},[t._v("商家状态")]),t._v(" "),e("em",[t._v(t._s(t.merchantState?"上架":"下架"))]),t._v(" "),e("zs-switch",{staticClass:"merchant-state-switch",model:{value:t.merchantState,callback:function(i){t.merchantState=i},expression:"merchantState"}})],1),t._v(" "),e("li",{staticClass:"merchant-pic"},[e("p",{staticClass:"insert-detail-title"},[e("span",[t._v("商家图片")]),t._v(" "),t.finalData.imgPath?e("label",{staticClass:"reset-pic",attrs:{for:"imgInput"}},[t._v("重新上传")]):t._e()]),t._v(" "),e("label",{staticClass:"image-label",class:[{"add-label":!t.finalData.imgPath}],style:{backgroundImage:"url("+t.imgShow+")"},attrs:{for:"imgInput"}},[e("input",{staticClass:"imgInput",attrs:{id:"imgInput",type:"file",accept:"image/*"},on:{change:t.hangleUpLoad}})])]),t._v(" "),e("li",{staticClass:"merchant-desc"},[e("span",{staticClass:"insert-detail-title"},[t._v("商家描述")]),t._v(" "),e("zs-input",{attrs:{type:"textarea",resize:"none",placeholder:"请输入商家描述"},model:{value:t.finalData.businessDetail,callback:function(i){t.finalData.businessDetail=i},expression:"finalData.businessDetail"}})],1)]),t._v(" "),e("div",{staticClass:"confirm-button",on:{click:t.handleSubmit}},[t._v("保存")]),t._v(" "),e("city-picker",{on:{"get-address":t.handleGetAddress},model:{value:t.cityPickerVisible,callback:function(i){t.cityPickerVisible=i},expression:"cityPickerVisible"}}),t._v(" "),e("div",{attrs:{id:"map"}})],1)},staticRenderFns:[]}},36:function(t,i){},407:function(t,i){},494:function(t,i,e){t.exports=e(91)},91:function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var s=e(1),a=e(264),n=e.n(a),r=e(5),c=(e.n(r),e(3),e(4));s.a.use(c.a),new s.a({el:"#app",render:function(t){return t(n.a)}})}},[494]);