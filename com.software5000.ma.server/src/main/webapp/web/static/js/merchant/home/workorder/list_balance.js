webpackJsonp([2],{180:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(7),s=a.n(n),i=a(276),r=a.n(i),o=a(275),c=a.n(o),l=a(6),d=a.n(l),u=a(1);t.default={components:{maHead:d.a,tab:s.a,unbalance:r.a,settled:c.a},data:function(){return{tabs:["未结算","已结算"],currTab:1,isLoading:!0}},computed:{comps:function(){return[r.a,c.a][this.currTab-1]}},methods:{handleTabChange:function(e){u.n.add({tab:e}),this.currTab=e}},created:function(){this.currTab=u.n.parse()?u.n.parse().tab||1:1}}},181:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(1);t.default={name:"settled",data:function(){return{context:this,closingDate:100,settledData:[],settledColumns:[{title:"工单编号",key:"orderNo",width:146},{title:"车牌号码",key:"carNumber",width:88},{title:"手机号",width:108,render:function(e){return e.mobile||"----"}},{title:"客户姓名",width:102,render:function(e){return e.realName||"--"}},{title:"施工项目",key:"itemNames",className:"item-name",width:300},{title:"实收金额",key:"totalPrice",width:92},{title:"收款方式",width:88,render:function(e){return["","现金收款","微信支付"][e.payType||0]}},{title:"结算时间",key:"payTime",width:178},{title:"操作",width:146,className:"table-control",render:function(e,t,a){var n=e.opposite?'<a @click.stop="handleAntiSettled('+e.id+","+a+')">反结算</a>':"";return'<a @click.stop="handleCheck('+e.id+')">查看</a>'+n}}],settledPage:{startPage:1,pageSize:10,total:10},tempData:{state:4,startTime:"",endTime:"",payType:"",searchKey:""},excelData:{state:4,startTime:"",endTime:"",payType:"",searchKey:""}}},methods:{handlePageChange:function(e){this.settledPage.startPage=e;var t=this.$loading();this.selectWorkOrder(function(){t.close()},t)},handlePageSizeChange:function(e){this.settledPage.pageSize=e;var t=this.$loading();this.selectWorkOrder(function(){t.close()},t)},handleSearch:function(){this.settledPage.startPage=1;var e=n.g.swapTime(this.tempData.startTime,this.tempData.endTime);this.tempData.startTime=e[0],this.tempData.endTime=e[1],Object.assign(this.excelData,this.tempData);var t=this.$loading();this.selectWorkOrder(function(){t.close()},t)},selectWorkOrder:function(e,t){var s=this;this.$ajax(this.$joggle.merchant.workorder.selectWorkOrderByPage,{state:4,startPage:this.settledPage.startPage,pageSize:this.settledPage.pageSize,startTime:a.i(n.c)(this.excelData.startTime)?"":this.excelData.startTime+" 00:00:00",endTime:a.i(n.c)(this.excelData.endTime)?"":this.excelData.endTime+" 23:59:59",searchKey:this.excelData.searchKey,payType:-1==this.excelData.payType?"":this.excelData.payType},t,function(t){"ZS011000"===t.code?(s.settledPage.total=t.data.total,s.settledData=t.data.list,Object.assign(s.tempData,s.excelData)):s.$message({type:"error",message:t.msg,duration:1200}),e&&e()})},selectClosingDate:function(e,t){var s=this;this.$ajax(this.$joggle.merchant.workorder.selectBusinessInfo,{},t,function(t){"ZS011000"===t.code?!a.i(n.c)(t.data)&&(s.closingDate=t.data.closingDateNum||100):s.$message({type:"error",message:t.msg,duration:1200}),e&&e()})},handleCheck:function(e){a.i(n.a)("/web/merchant/home/workorder/detail_balance.html",{id:e},!0)},handleAntiSettled:function(e,t){var s=this;return 2===this.settledData[t].payType?void this.$message({type:"error",message:"微信支付不能反结算!",duration:1200}):a.i(n.c)(this.settledData[t].couponUuid)?void this.$confirm({title:"反结算",type:"warning",message:"确认对该工单进行反结算?"}).then(function(){s.$ajax(s.$joggle.merchant.workorder.antiSettle,{orderId:e},!0,function(e,t){"ZS011000"===e.code?(1===s.settledData.length&&s.settledPage.startPage>1&&(s.startPage-=1),s.selectWorkOrder(function(){s.$message({type:"success",message:e.msg,duration:1200}),t.close()},t)):(t.close(),s.$message({type:"error",message:e.msg,duration:1200}))})}).catch(function(){}):void this.$message({type:"error",message:"该单已使用卡券不能反结算!",duration:1200})},handleDownLoad:function(){if(0===this.settledData.length)this.$message({type:"error",message:"暂无数据，无需导出表格！",duration:1200});else{var e={state:4,startTime:a.i(n.c)(this.excelData.startTime)?"":this.excelData.startTime+" 00:00:00",endTime:a.i(n.c)(this.excelData.endTime)?"":this.excelData.endTime+" 23:59:59",searchKey:this.excelData.searchKey,payType:-1==this.excelData.payType?"":this.excelData.payType};a.i(n.a)(this.$joggle.merchant.workorder.downLoadWorkOrder,e)}}},created:function(){var e=this,t=this.$loading();this.selectClosingDate(function(){e.selectWorkOrder(function(){e.$emit("input",!1),t.close()},t)},t)}}},182:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(1);t.default={name:"unbalance",data:function(){return{context:this,unbalanceData:[],unbalanceColumns:[{title:"工单编号",key:"orderNo",width:130},{title:"车牌号码",key:"carNumber",width:90},{title:"手机号",width:108,render:function(e){return e.mobile||"----"}},{title:"客户姓名",width:100,render:function(e){return e.realName||"--"}},{title:"施工项目",key:"itemNames",className:"item-name",width:300},{title:"费用",key:"totalPrice",width:96},{title:"开单时间",key:"createTime",width:158},{title:"完工时间",key:"commitTime",width:160},{title:"操作",width:98,className:"table-control",render:function(e){return'<a @click.stop="handleToSettle('+e.id+')">去结算</a>\n                                <a @click.stop="handleDelOrder('+e.id+')">删除</a>'}}],unbalancePage:{startPage:1,pageSize:10,total:0}}},methods:{handlePageChange:function(e){this.unbalancePage.startPage=e,this.selectWorkOrder()},handlePageSizeChange:function(e){this.unbalancePage.pageSize=e,this.selectWorkOrder()},selectWorkOrder:function(e){var t=this;this.$ajax(this.$joggle.merchant.workorder.selectWorkOrderByPage,{state:3,startPage:this.unbalancePage.startPage,pageSize:this.unbalancePage.pageSize},!0,function(a,n){n.close(),"ZS011000"===a.code?(t.unbalancePage.total=a.data.total,t.unbalanceData=a.data.list):t.$message({type:"error",message:a.msg,duration:1200}),e&&e()})},handleToSettle:function(e){a.i(n.a)("/web/merchant/home/workorder/detail_pay.html",{id:e})},handleDelOrder:function(e){var t=this;this.$confirm({title:"删除",type:"delete",message:"确认删除该工单?"}).then(function(){t.$ajax(t.$joggle.merchant.workorder.deleteWorkOrderById,{orderId:e},!0,function(e,a){"ZS011000"===e.code?(1===t.unbalanceData.length&&t.unbalancePage.startPage>1&&(t.unbalancePage.startPage-=1),t.selectWorkOrder(function(e){t.$message({type:"success",message:"删除成功!",duration:1200}),a.close()},a)):(a.close(),t.$message({type:"error",message:e.msg,duration:1200}))})}).catch(function(){})}},created:function(){var e=this;this.selectWorkOrder(function(){e.$emit("input",!1)})}}},274:function(e,t,a){function n(e){a(412)}var s=a(0)(a(180),a(332),n,null,null);e.exports=s.exports},275:function(e,t,a){function n(e){a(382)}var s=a(0)(a(181),a(287),n,null,null);e.exports=s.exports},276:function(e,t,a){function n(e){a(426)}var s=a(0)(a(182),a(359),n,null,null);e.exports=s.exports},287:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page-main"},[a("div",{staticClass:"page-main-form"},[a("zs-button",{staticClass:"download-btn",attrs:{type:"primary"}},[a("zs-icon",{attrs:{icon:"download",size:"20",text:"导出表格"},on:{click:e.handleDownLoad}})],1),e._v(" "),a("zs-button",{staticClass:"search-btn fr",attrs:{type:"primary"},on:{click:e.handleSearch}},[a("zs-icon",{attrs:{icon:"search2",size:"19"}})],1),e._v(" "),a("zs-input",{staticClass:"search-input fr",attrs:{icon:"circle-cross",placeholder:"请输入手机号、车牌号关键词"},model:{value:e.tempData.searchKey,callback:function(t){e.tempData.searchKey="string"==typeof t?t.trim():t},expression:"tempData.searchKey"}}),e._v(" "),a("zs-select",{staticClass:"pay-type-select fr",attrs:{placeholder:"收款方式选择"},model:{value:e.tempData.payType,callback:function(t){e.tempData.payType=t},expression:"tempData.payType"}},[a("zs-option",{attrs:{value:"-1",label:"不限"}}),e._v(" "),a("zs-option",{attrs:{value:1,label:"现金收款"}}),e._v(" "),a("zs-option",{attrs:{value:2,label:"微信支付"}})],1),e._v(" "),a("date-picker",{staticClass:"date-picker fr",attrs:{placeholder:"请选择结束时间"},model:{value:e.tempData.endTime,callback:function(t){e.tempData.endTime=t},expression:"tempData.endTime"}}),e._v(" "),a("span",{staticClass:"fr"},[e._v("-")]),e._v(" "),a("date-picker",{staticClass:"date-picker fr",attrs:{placeholder:"请选择开始时间"},model:{value:e.tempData.startTime,callback:function(t){e.tempData.startTime=t},expression:"tempData.startTime"}}),e._v(" "),a("span",{staticClass:"fr"},[e._v("结算时间")])],1),e._v(" "),a("zs-table",{attrs:{data:e.settledData,columns:e.settledColumns,context:e.context,"no-data-colspan":9,"no-data-text":"暂无工单",border:""}}),e._v(" "),e.settledData.length>0?a("zs-pagination",{attrs:{current:e.settledPage.startPage,total:e.settledPage.total,"page-size":e.settledPage.pageSize,"show-total":"","show-elevator":"","show-sizer":""},on:{"on-change":e.handlePageChange,"on-page-size-change":e.handlePageSizeChange},slot:"footer"}):e._e()],1)},staticRenderFns:[]}},332:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"show",rawName:"v-show",value:!e.isLoading,expression:"!isLoading"}],staticClass:"workorder-page"},[a("ma-head",{attrs:{"curr-id":"02"}}),e._v(" "),a("zs-breadcrumb",{attrs:{separator:"arrow-right"}},[a("zs-breadcrumb-item",[e._v("工单结算")])],1),e._v(" "),a("tab",{attrs:{tabs:e.tabs,current:e.currTab},on:{change:e.handleTabChange}}),e._v(" "),a(e.comps,{tag:"component",model:{value:e.isLoading,callback:function(t){e.isLoading=t},expression:"isLoading"}})],1)},staticRenderFns:[]}},359:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page-main"},[a("zs-table",{attrs:{data:e.unbalanceData,columns:e.unbalanceColumns,context:e.context,"no-data-colspan":9,"no-data-text":"暂无工单",border:""}}),e._v(" "),e.unbalanceData.length>0?a("zs-pagination",{attrs:{current:e.unbalancePage.startPage,total:e.unbalancePage.total,"page-size":e.unbalancePage.pageSize,"show-total":"","show-elevator":"","show-sizer":""},on:{"on-change":e.handlePageChange,"on-page-size-change":e.handlePageSizeChange},slot:"footer"}):e._e()],1)},staticRenderFns:[]}},382:function(e,t){},412:function(e,t){},426:function(e,t){},471:function(e,t,a){e.exports=a(61)},61:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(2),s=a(274),i=a.n(s),r=a(5),o=(a.n(r),a(3),a(4));n.a.use(o.a),new n.a({el:"#app",render:function(e){return e(i.a)}})}},[471]);